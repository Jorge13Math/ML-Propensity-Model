
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>This notebook help to create a model to find next potential clients &#8212; Datacentric Tecnical Test</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Methodology" href="../../Explanation.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  
  <h1 class="site-logo" id="site-title">Datacentric Tecnical Test</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../Explanation.html">
   Methodology
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../Explanation.html#conclusion">
   Conclusion
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/code/notebooks/Analysis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/code/notebooks/Analysis.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   This notebook help to create a model to find next potential clients
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-data-and-overview">
   Loading data and overview
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eda">
   EDA
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-of-missing-values">
     Analysis of Missing Values
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-of-target-value">
     Analysis of target value
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-of-categorical-variables">
     Analysis of Categorical Variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analysis-of-numerical-variables">
     Analysis of Numerical Variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correlation-between-variables">
     Correlation between variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#preprocess-data">
   Preprocess Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imputation-of-missing-values-in-numerical-data">
     1- Imputation of Missing Values in numerical Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#encoded-categorical-variables-to-numeric">
     2- Encoded Categorical variables to numeric
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#imputation-of-missing-values-in-categorical-data-with-knnimput">
     3- Imputation of Missing Values in categorical Data with KnnImput
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selecting-the-companies-that-are-not-potential-clients">
     4 - Selecting the companies that are not potential clients
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-dataset-to-train-a-model">
     5- Creating dataset to train a model
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#take-a-look-to-the-data">
     6- Take a look to the data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#split-data-to-train-the-model">
     7 Split data to train the model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#train-a-model">
   Train a Model
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#try-difference-clasifier">
     Try Difference Clasifier
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#try-mlp">
     Try MLP
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#try-logisticregression">
     Try LogisticRegression.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#choosing-the-best-model">
   Choosing the best model
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-prediction">
   Making Prediction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#criteria-final-in-the-choice-of-companies">
     Criteria final in the choice of companies
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="this-notebook-help-to-create-a-model-to-find-next-potential-clients">
<h1>This notebook help to create a model to find next potential clients<a class="headerlink" href="#this-notebook-help-to-create-a-model-to-find-next-potential-clients" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="imports">
<h1>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">&#39;../&#39;</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">&#39;../../&#39;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">scripts.create_dataset</span> <span class="kn">import</span> <span class="n">genererate_dataframe</span>
<span class="kn">from</span> <span class="nn">scripts.utils</span> <span class="kn">import</span> <span class="n">Utils</span>
<span class="kn">from</span> <span class="nn">scripts.preprocess_data</span> <span class="kn">import</span> <span class="n">Preprocces</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="loading-data-and-overview">
<h1>Loading data and overview<a class="headerlink" href="#loading-data-and-overview" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;../../data/&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_data</span><span class="p">,</span><span class="n">df_client</span> <span class="o">=</span> <span class="n">genererate_dataframe</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2021-02-07][15:18:30][scripts.create_dataset][INFO] Loading files
[2021-02-07][15:18:30][scripts.create_dataset][INFO] Dataframes generated
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>tipo_empresa</th>
      <th>codpostal</th>
      <th>municipio</th>
      <th>provincia</th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>habitantes_municipio</th>
      <th>tipo_de_zona</th>
      <th>...</th>
      <th>flotacamiones</th>
      <th>flotaautobuses</th>
      <th>riesgo</th>
      <th>universo</th>
      <th>existe_import</th>
      <th>existe_export</th>
      <th>existe_importexport</th>
      <th>existe_email</th>
      <th>es_ecommerce</th>
      <th>impactos_publicidad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>E</td>
      <td>46008</td>
      <td>VALENCIA</td>
      <td>VALENCIA</td>
      <td>COMUNITAT VALENCIANA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>786189</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>E</td>
      <td>28049</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>3141991</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>E</td>
      <td>8172</td>
      <td>SANT CUGAT DEL VALLÈS</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>87830</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>E</td>
      <td>8011</td>
      <td>BARCELONA</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>1604555</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>E</td>
      <td>28031</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>1</td>
      <td>3141991</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 33 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_data</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;tipo_empresa&#39;, &#39;codpostal&#39;, &#39;municipio&#39;, &#39;provincia&#39;,
       &#39;comunidadautonoma&#39;, &#39;capitalpueblo&#39;, &#39;enpoligono&#39;,
       &#39;habitantes_municipio&#39;, &#39;tipo_de_zona&#39;, &#39;actcnae&#39;, &#39;mercado&#39;,
       &#39;cnae_mercado&#39;, &#39;rangoventas&#39;, &#39;rangoempleados&#39;, &#39;numoficinas&#39;,
       &#39;tipooficina&#39;, &#39;anyofundacion&#39;, &#39;nse&#39;, &#39;tendenciaempleados&#39;,
       &#39;tendenciaingresos&#39;, &#39;flotaturismos&#39;, &#39;flotafurgonetas&#39;,
       &#39;flotacamiones&#39;, &#39;flotaautobuses&#39;, &#39;riesgo&#39;, &#39;universo&#39;,
       &#39;existe_import&#39;, &#39;existe_export&#39;, &#39;existe_importexport&#39;, &#39;existe_email&#39;,
       &#39;es_ecommerce&#39;, &#39;impactos_publicidad&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id                        int64
tipo_empresa             object
codpostal                 int64
municipio                object
provincia                object
comunidadautonoma        object
capitalpueblo            object
enpoligono                int64
habitantes_municipio      int64
tipo_de_zona              int64
actcnae                  object
mercado                  object
cnae_mercado             object
rangoventas             float64
rangoempleados          float64
numoficinas             float64
tipooficina              object
anyofundacion            object
nse                       int64
tendenciaempleados       object
tendenciaingresos        object
flotaturismos             int64
flotafurgonetas           int64
flotacamiones             int64
flotaautobuses            int64
riesgo                   object
universo                 object
existe_import             int64
existe_export             int64
existe_importexport       int64
existe_email              int64
es_ecommerce              int64
impactos_publicidad       int64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>tipo_empresa</th>
      <th>codpostal</th>
      <th>municipio</th>
      <th>provincia</th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>habitantes_municipio</th>
      <th>tipo_de_zona</th>
      <th>...</th>
      <th>flotacamiones</th>
      <th>flotaautobuses</th>
      <th>riesgo</th>
      <th>universo</th>
      <th>existe_import</th>
      <th>existe_export</th>
      <th>existe_importexport</th>
      <th>existe_email</th>
      <th>es_ecommerce</th>
      <th>impactos_publicidad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>E</td>
      <td>46008</td>
      <td>VALENCIA</td>
      <td>VALENCIA</td>
      <td>COMUNITAT VALENCIANA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>786189</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>E</td>
      <td>28049</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>3141991</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>E</td>
      <td>8172</td>
      <td>SANT CUGAT DEL VALLÈS</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>87830</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>E</td>
      <td>8011</td>
      <td>BARCELONA</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>1604555</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>E</td>
      <td>28031</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>1</td>
      <td>3141991</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>99996</td>
      <td>E</td>
      <td>8860</td>
      <td>CASTELLDEFELS</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>63891</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>99997</td>
      <td>E</td>
      <td>29018</td>
      <td>MÁLAGA</td>
      <td>MALAGA</td>
      <td>ANDALUCIA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>569130</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>99998</td>
      <td>E</td>
      <td>46980</td>
      <td>PATERNA</td>
      <td>VALENCIA</td>
      <td>COMUNITAT VALENCIANA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>67340</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>99999</td>
      <td>E</td>
      <td>8021</td>
      <td>BARCELONA</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>1604555</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>100000</td>
      <td>E</td>
      <td>41011</td>
      <td>SEVILLA</td>
      <td>SEVILLA</td>
      <td>ANDALUCIA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>693878</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 33 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 33)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_client</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_client</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5278, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_client</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Creating a new column called client that contain:</p>
<p><strong>1:</strong> is a client
<strong>0:</strong> is not a client</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Id</span> <span class="o">=</span> <span class="n">df_client</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">Id</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now the datatset is ready to be analyzed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>tipo_empresa</th>
      <th>codpostal</th>
      <th>municipio</th>
      <th>provincia</th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>habitantes_municipio</th>
      <th>tipo_de_zona</th>
      <th>...</th>
      <th>flotaautobuses</th>
      <th>riesgo</th>
      <th>universo</th>
      <th>existe_import</th>
      <th>existe_export</th>
      <th>existe_importexport</th>
      <th>existe_email</th>
      <th>es_ecommerce</th>
      <th>impactos_publicidad</th>
      <th>client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>E</td>
      <td>46008</td>
      <td>VALENCIA</td>
      <td>VALENCIA</td>
      <td>COMUNITAT VALENCIANA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>786189</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>E</td>
      <td>28049</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>3141991</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>E</td>
      <td>8172</td>
      <td>SANT CUGAT DEL VALLÈS</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>87830</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>E</td>
      <td>8011</td>
      <td>BARCELONA</td>
      <td>BARCELONA</td>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>1604555</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>E</td>
      <td>28031</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>1</td>
      <td>3141991</td>
      <td>7</td>
      <td>...</td>
      <td>0</td>
      <td>NaN</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 34 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="eda">
<h1>EDA<a class="headerlink" href="#eda" title="Permalink to this headline">¶</a></h1>
<p>In this section the data will be analyzed. This process is very important as it helps to find important patterns and characteristics in the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>100000.0</td>
      <td>50000.500000</td>
      <td>2.886766e+04</td>
      <td>1.0</td>
      <td>25000.75</td>
      <td>50000.5</td>
      <td>75000.25</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>codpostal</th>
      <td>100000.0</td>
      <td>23680.691800</td>
      <td>1.408236e+04</td>
      <td>1001.0</td>
      <td>8710.00</td>
      <td>28004.0</td>
      <td>30820.00</td>
      <td>51002.0</td>
    </tr>
    <tr>
      <th>enpoligono</th>
      <td>100000.0</td>
      <td>0.170770</td>
      <td>3.763097e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>habitantes_municipio</th>
      <td>100000.0</td>
      <td>637943.890040</td>
      <td>1.046474e+06</td>
      <td>0.0</td>
      <td>14420.00</td>
      <td>87830.0</td>
      <td>693878.00</td>
      <td>3141991.0</td>
    </tr>
    <tr>
      <th>tipo_de_zona</th>
      <td>100000.0</td>
      <td>4.710400</td>
      <td>2.134830e+00</td>
      <td>1.0</td>
      <td>3.00</td>
      <td>5.0</td>
      <td>7.00</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>rangoventas</th>
      <td>99999.0</td>
      <td>3.222532</td>
      <td>2.084130e+00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>3.0</td>
      <td>5.00</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>rangoempleados</th>
      <td>95996.0</td>
      <td>107.880849</td>
      <td>1.309027e+01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>105.0</td>
      <td>110.00</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>numoficinas</th>
      <td>95946.0</td>
      <td>0.120057</td>
      <td>2.170808e+00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>337.0</td>
    </tr>
    <tr>
      <th>nse</th>
      <td>100000.0</td>
      <td>2.686010</td>
      <td>1.818663e+00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>3.0</td>
      <td>4.00</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>flotaturismos</th>
      <td>100000.0</td>
      <td>0.084630</td>
      <td>2.783317e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>flotafurgonetas</th>
      <td>100000.0</td>
      <td>0.056730</td>
      <td>2.313271e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>flotacamiones</th>
      <td>100000.0</td>
      <td>0.017580</td>
      <td>1.314196e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>flotaautobuses</th>
      <td>100000.0</td>
      <td>0.000490</td>
      <td>2.213063e-02</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_import</th>
      <td>100000.0</td>
      <td>0.017830</td>
      <td>1.323339e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_export</th>
      <td>100000.0</td>
      <td>0.038560</td>
      <td>1.925448e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_importexport</th>
      <td>100000.0</td>
      <td>0.014250</td>
      <td>1.185204e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_email</th>
      <td>100000.0</td>
      <td>0.250170</td>
      <td>4.331130e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>es_ecommerce</th>
      <td>100000.0</td>
      <td>0.009420</td>
      <td>9.659895e-02</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>impactos_publicidad</th>
      <td>100000.0</td>
      <td>1.557230</td>
      <td>2.287199e+00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
      <td>2.00</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>client</th>
      <td>100000.0</td>
      <td>0.052780</td>
      <td>2.235951e-01</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>0.00</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 34 columns):
 #   Column                Non-Null Count   Dtype  
---  ------                --------------   -----  
 0   id                    100000 non-null  int64  
 1   tipo_empresa          100000 non-null  object 
 2   codpostal             100000 non-null  int64  
 3   municipio             100000 non-null  object 
 4   provincia             100000 non-null  object 
 5   comunidadautonoma     100000 non-null  object 
 6   capitalpueblo         100000 non-null  object 
 7   enpoligono            100000 non-null  int64  
 8   habitantes_municipio  100000 non-null  int64  
 9   tipo_de_zona          100000 non-null  int64  
 10  actcnae               99990 non-null   object 
 11  mercado               99990 non-null   object 
 12  cnae_mercado          100000 non-null  object 
 13  rangoventas           99999 non-null   float64
 14  rangoempleados        95996 non-null   float64
 15  numoficinas           95946 non-null   float64
 16  tipooficina           100000 non-null  object 
 17  anyofundacion         90996 non-null   object 
 18  nse                   100000 non-null  int64  
 19  tendenciaempleados    46187 non-null   object 
 20  tendenciaingresos     37883 non-null   object 
 21  flotaturismos         100000 non-null  int64  
 22  flotafurgonetas       100000 non-null  int64  
 23  flotacamiones         100000 non-null  int64  
 24  flotaautobuses        100000 non-null  int64  
 25  riesgo                628 non-null     object 
 26  universo              99987 non-null   object 
 27  existe_import         100000 non-null  int64  
 28  existe_export         100000 non-null  int64  
 29  existe_importexport   100000 non-null  int64  
 30  existe_email          100000 non-null  int64  
 31  es_ecommerce          100000 non-null  int64  
 32  impactos_publicidad   100000 non-null  int64  
 33  client                100000 non-null  int64  
dtypes: float64(3), int64(17), object(14)
memory usage: 25.9+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 34)
</pre></div>
</div>
</div>
</div>
<p>Creating a list type variable called <strong>col_remove</strong>, in which the features that are not important for our goal will be added</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="analysis-of-missing-values">
<h2>Analysis of Missing Values<a class="headerlink" href="#analysis-of-missing-values" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>id                          0
tipo_empresa                0
codpostal                   0
municipio                   0
provincia                   0
comunidadautonoma           0
capitalpueblo               0
enpoligono                  0
habitantes_municipio        0
tipo_de_zona                0
actcnae                    10
mercado                    10
cnae_mercado                0
rangoventas                 1
rangoempleados           4004
numoficinas              4054
tipooficina                 0
anyofundacion            9004
nse                         0
tendenciaempleados      53813
tendenciaingresos       62117
flotaturismos               0
flotafurgonetas             0
flotacamiones               0
flotaautobuses              0
riesgo                  99372
universo                   13
existe_import               0
existe_export               0
existe_importexport         0
existe_email                0
es_ecommerce                0
impactos_publicidad         0
client                      0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Loading a class called Utils, this class helps to vizualize the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span> <span class="o">=</span> <span class="n">Utils</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2021-02-07][15:18:37][scripts.utils][INFO] Class is initialized
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variables_nan</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_31_0.png" src="../../_images/Analysis_31_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variables</th>
      <th>Number_of_nan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>tipo_empresa</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>codpostal</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>municipio</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>provincia</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>comunidadautonoma</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>capitalpueblo</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>enpoligono</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>habitantes_municipio</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>tipo_de_zona</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>actcnae</td>
      <td>10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>mercado</td>
      <td>10</td>
    </tr>
    <tr>
      <th>12</th>
      <td>cnae_mercado</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>rangoventas</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>rangoempleados</td>
      <td>4004</td>
    </tr>
    <tr>
      <th>15</th>
      <td>numoficinas</td>
      <td>4054</td>
    </tr>
    <tr>
      <th>16</th>
      <td>tipooficina</td>
      <td>0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>anyofundacion</td>
      <td>9004</td>
    </tr>
    <tr>
      <th>18</th>
      <td>nse</td>
      <td>0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>tendenciaempleados</td>
      <td>53813</td>
    </tr>
    <tr>
      <th>20</th>
      <td>tendenciaingresos</td>
      <td>62117</td>
    </tr>
    <tr>
      <th>21</th>
      <td>flotaturismos</td>
      <td>0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>flotafurgonetas</td>
      <td>0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>flotacamiones</td>
      <td>0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>flotaautobuses</td>
      <td>0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>riesgo</td>
      <td>99372</td>
    </tr>
    <tr>
      <th>26</th>
      <td>universo</td>
      <td>13</td>
    </tr>
    <tr>
      <th>27</th>
      <td>existe_import</td>
      <td>0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>existe_export</td>
      <td>0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>existe_importexport</td>
      <td>0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>existe_email</td>
      <td>0</td>
    </tr>
    <tr>
      <th>31</th>
      <td>es_ecommerce</td>
      <td>0</td>
    </tr>
    <tr>
      <th>32</th>
      <td>impactos_publicidad</td>
      <td>0</td>
    </tr>
    <tr>
      <th>33</th>
      <td>client</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Removing the <strong>riesgo</strong> variable since it has more than 99% the NaN</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;riesgo&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 33)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analysis-of-target-value">
<h2>Analysis of target value<a class="headerlink" href="#analysis-of-target-value" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;client&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_37_0.png" src="../../_images/Analysis_37_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    94722
1     5278
Name: client, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percentage of target 0 : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="si">}</span><span class="s2"> %&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of target 0 : 95 %
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Percentage of target 1 : </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="si">}</span><span class="s2"> %&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Percentage of target 1 : 5 %
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="analysis-of-categorical-variables">
<h2>Analysis of Categorical Variables<a class="headerlink" href="#analysis-of-categorical-variables" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;tipo_empresa&#39;, &#39;municipio&#39;, &#39;provincia&#39;, &#39;comunidadautonoma&#39;,
       &#39;capitalpueblo&#39;, &#39;actcnae&#39;, &#39;mercado&#39;, &#39;cnae_mercado&#39;, &#39;tipooficina&#39;,
       &#39;anyofundacion&#39;, &#39;tendenciaempleados&#39;, &#39;tendenciaingresos&#39;, &#39;universo&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tipo_empresa&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tipo_empresa&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_43_0.png" src="../../_images/Analysis_43_0.png" />
<img alt="../../_images/Analysis_43_1.png" src="../../_images/Analysis_43_1.png" />
</div>
</div>
<p>This dataframe represents the percentage of the customer per variable.</p>
<p><strong>Columns:</strong> 1: is a client, 0: is not a client</p>
<p><strong>Row:</strong> Variable value</p>
<p>This percentage will be taken into account for the selection of variables to eliminate.</p>
<p>This process is carried out with all variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>E</th>
      <td>99.672727</td>
      <td>99.962107</td>
    </tr>
    <tr>
      <th>O</th>
      <td>0.327273</td>
      <td>0.037893</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This variable <strong>tipo_empresa</strong> is added to col_remove since there is no difference between customer and non-customer. 99% of clients are companies</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;tipo_empresa&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;comunidadautonoma&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;comunidadautonoma&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_48_0.png" src="../../_images/Analysis_48_0.png" />
<img alt="../../_images/Analysis_48_1.png" src="../../_images/Analysis_48_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_community</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_community</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_community</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CATALUNYA</th>
      <td>26.586221</td>
      <td>38.897310</td>
    </tr>
    <tr>
      <th>MADRID</th>
      <td>21.268554</td>
      <td>19.893899</td>
    </tr>
    <tr>
      <th>COMUNITAT VALENCIANA</th>
      <td>10.955216</td>
      <td>9.378552</td>
    </tr>
    <tr>
      <th>ANDALUCIA</th>
      <td>13.522730</td>
      <td>8.791209</td>
    </tr>
    <tr>
      <th>PAIS VASCO</th>
      <td>4.894322</td>
      <td>5.323986</td>
    </tr>
    <tr>
      <th>GALICIA</th>
      <td>4.299951</td>
      <td>3.524062</td>
    </tr>
    <tr>
      <th>CASTILLA Y LEON</th>
      <td>4.431917</td>
      <td>2.823039</td>
    </tr>
    <tr>
      <th>ARAGON</th>
      <td>2.722704</td>
      <td>2.406214</td>
    </tr>
    <tr>
      <th>CASTILLA-LA MANCHA</th>
      <td>2.905344</td>
      <td>2.387268</td>
    </tr>
    <tr>
      <th>MURCIA</th>
      <td>2.461941</td>
      <td>1.610459</td>
    </tr>
    <tr>
      <th>NAVARRA</th>
      <td>1.361880</td>
      <td>1.458886</td>
    </tr>
    <tr>
      <th>ASTURIAS</th>
      <td>1.337598</td>
      <td>1.345207</td>
    </tr>
    <tr>
      <th>EXTREMADURA</th>
      <td>1.630033</td>
      <td>0.985222</td>
    </tr>
    <tr>
      <th>LA RIOJA</th>
      <td>0.756952</td>
      <td>0.625237</td>
    </tr>
    <tr>
      <th>CANTABRIA</th>
      <td>0.837187</td>
      <td>0.492611</td>
    </tr>
    <tr>
      <th>BALEARS</th>
      <td>0.016892</td>
      <td>0.056840</td>
    </tr>
    <tr>
      <th>CANARIAS</th>
      <td>0.009501</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>CEUTA</th>
      <td>0.001056</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_community</span><span class="p">[</span><span class="n">df_community</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.80901856763924
</pre></div>
</div>
</div>
</div>
<p>Creating a new variable called <strong>community_not_client</strong>. This variable contains the communities that do not belong to 85% of the clients</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">community_not_client</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_community</span><span class="p">[</span><span class="n">df_community</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">community_not_client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;CASTILLA Y LEON&#39;,
 &#39;ARAGON&#39;,
 &#39;CASTILLA-LA MANCHA&#39;,
 &#39;MURCIA&#39;,
 &#39;NAVARRA&#39;,
 &#39;ASTURIAS&#39;,
 &#39;EXTREMADURA&#39;,
 &#39;LA RIOJA&#39;,
 &#39;CANTABRIA&#39;,
 &#39;BALEARS&#39;,
 &#39;CANARIAS&#39;,
 &#39;CEUTA&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;capitalpueblo&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;capitalpueblo&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_53_0.png" src="../../_images/Analysis_53_0.png" />
<img alt="../../_images/Analysis_53_1.png" src="../../_images/Analysis_53_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PUEBLO</th>
      <td>58.273685</td>
      <td>60.629026</td>
    </tr>
    <tr>
      <th>CAPITAL</th>
      <td>41.726315</td>
      <td>39.370974</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_actcnae</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;actcnae&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_actcnae</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actcnae</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>COMERCIO AL POR MAYOR E INTERMEDIARIOS DEL COM...</td>
      <td>2932</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AGENTES DE LA PROPIEDAD INMOBILIARIA</td>
      <td>2752</td>
    </tr>
    <tr>
      <th>2</th>
      <td>PELUQUERÍA Y OTROS TRATAMIENTOS DE BELLEZA</td>
      <td>2504</td>
    </tr>
    <tr>
      <th>3</th>
      <td>INSTALACIONES ELÉCTRICAS</td>
      <td>2337</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AGENCIAS DE PUBLICIDAD</td>
      <td>2126</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>557</th>
      <td>INTERMEDIARIOS DEL COMERCIO DE MAQUINARIA, EQU...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>558</th>
      <td>FABRICACIÓN DE OTRO MATERIAL Y EQUIPO ELÉCTRICO</td>
      <td>1</td>
    </tr>
    <tr>
      <th>559</th>
      <td>SEGUROS DE VIDA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>560</th>
      <td>ACTIVIDADES DE CONSTRUCCIÓN ESPECIALIZADA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>561</th>
      <td>ALQUILER DE OTRA MAQUINARIA, EQUIPOS Y BIENES ...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>562 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_actcnae_class</span><span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;actcnae&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_actcnae_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>COMERCIO AL POR MAYOR E INTERMEDIARIOS DEL COMERCIO, EXCEPTO DE VEHÍCULOS DE MOTOR Y MOTOCICLETAS</th>
      <td>2.920432</td>
      <td>3.145131</td>
    </tr>
    <tr>
      <th>COMERCIO AL POR MENOR POR CORRESPONDENCIA O INTERNET</th>
      <td>1.259608</td>
      <td>3.145131</td>
    </tr>
    <tr>
      <th>OTRAS ACTIVIDADES DE IMPRESIÓN Y ARTES GRÁFICAS</th>
      <td>0.920686</td>
      <td>2.936718</td>
    </tr>
    <tr>
      <th>AGENCIAS DE PUBLICIDAD</th>
      <td>2.091604</td>
      <td>2.747253</td>
    </tr>
    <tr>
      <th>COMERCIO AL POR MAYOR DE MÁQUINAS HERRAMIENTA</th>
      <td>1.277557</td>
      <td>2.728306</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>INTERMEDIARIOS DEL COMERCIO DE MAQUINARIA, EQUIPO INDUSTRIAL, EMBARCACIONES Y AERONAVES</th>
      <td>0.001056</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FABRICACIÓN DE OTRO MATERIAL Y EQUIPO ELÉCTRICO</th>
      <td>0.001056</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SEGUROS DE VIDA</th>
      <td>0.001056</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ACTIVIDADES DE CONSTRUCCIÓN ESPECIALIZADA</th>
      <td>0.001056</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>ALQUILER DE OTRA MAQUINARIA, EQUIPOS Y BIENES TANGIBLES</th>
      <td>0.001056</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>562 rows × 2 columns</p>
</div></div></div>
</div>
<p>Adding the <strong>actcnae</strong> variable since the <strong>cnae_mercado</strong> variable will be taken into account since it encompasses a <strong>actcnae</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;actcnae&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;mercado&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;mercado&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_61_0.png" src="../../_images/Analysis_61_0.png" />
<img alt="../../_images/Analysis_61_1.png" src="../../_images/Analysis_61_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ALIMENTACION Y BEBIDAS</th>
      <td>11.690177</td>
      <td>12.201592</td>
    </tr>
    <tr>
      <th>MAQUINARIA, EQUIPO Y APARATOS</th>
      <td>3.784103</td>
      <td>7.218643</td>
    </tr>
    <tr>
      <th>TEXTIL Y CONFECCION</th>
      <td>4.966636</td>
      <td>6.839712</td>
    </tr>
    <tr>
      <th>ELECTRICIDAD Y ELECTRONICA</th>
      <td>4.938128</td>
      <td>5.361879</td>
    </tr>
    <tr>
      <th>COMERCIO MAYORISTA</th>
      <td>3.788327</td>
      <td>4.736643</td>
    </tr>
    <tr>
      <th>EMPRESAS DE SERVICIOS</th>
      <td>7.919799</td>
      <td>4.641910</td>
    </tr>
    <tr>
      <th>ARTES GRAFICAS</th>
      <td>1.818143</td>
      <td>4.452444</td>
    </tr>
    <tr>
      <th>COSMETICA Y CUIDADO PERSONAL</th>
      <td>3.736591</td>
      <td>4.111406</td>
    </tr>
    <tr>
      <th>INFORMATICA</th>
      <td>5.113396</td>
      <td>3.467222</td>
    </tr>
    <tr>
      <th>PUBLICIDAD, RELACIONES PUBLICAS Y MARKETING</th>
      <td>2.841245</td>
      <td>3.372490</td>
    </tr>
    <tr>
      <th>HIERRO Y METAL</th>
      <td>2.864473</td>
      <td>3.315650</td>
    </tr>
    <tr>
      <th>VENTA A DISTANCIA</th>
      <td>1.253273</td>
      <td>3.107238</td>
    </tr>
    <tr>
      <th>PRENSA, EDITORIALES, RADIO Y TELEVISION</th>
      <td>2.669144</td>
      <td>2.974612</td>
    </tr>
    <tr>
      <th>QUIMICA</th>
      <td>1.529901</td>
      <td>2.860932</td>
    </tr>
    <tr>
      <th>VEHICULOS, RECAMBIOS Y ACCESORIOS</th>
      <td>3.178056</td>
      <td>2.652520</td>
    </tr>
    <tr>
      <th>COMERCIO MINORISTA</th>
      <td>2.030366</td>
      <td>2.235695</td>
    </tr>
    <tr>
      <th>EQUIPOS MEDICOS</th>
      <td>1.220542</td>
      <td>1.970443</td>
    </tr>
    <tr>
      <th>JOYERIA Y RELOJERIA</th>
      <td>1.079061</td>
      <td>1.913604</td>
    </tr>
    <tr>
      <th>PROFESIONALES LIBERALES</th>
      <td>2.824352</td>
      <td>1.743085</td>
    </tr>
    <tr>
      <th>ARTICULOS DEPORTIVOS, JUGUETES E INSTRUMENTOS MUSICALES</th>
      <td>1.006208</td>
      <td>1.743085</td>
    </tr>
    <tr>
      <th>MUEBLES</th>
      <td>1.728398</td>
      <td>1.724138</td>
    </tr>
    <tr>
      <th>TRANSPORTES Y TRAFICO</th>
      <td>2.207746</td>
      <td>1.591512</td>
    </tr>
    <tr>
      <th>CONSTRUCCION Y OBRAS PUBLICAS</th>
      <td>4.165259</td>
      <td>1.212581</td>
    </tr>
    <tr>
      <th>SANIDAD Y ASISTENCIA SOCIAL</th>
      <td>1.032604</td>
      <td>1.174687</td>
    </tr>
    <tr>
      <th>PLASTICO Y GOMA</th>
      <td>0.421277</td>
      <td>1.174687</td>
    </tr>
    <tr>
      <th>INGENIEROS, PERITOS Y EXPERTOS</th>
      <td>1.580581</td>
      <td>1.174687</td>
    </tr>
    <tr>
      <th>MATERIALES, ELEMENTOS E INSTALACIONES DE LA CONSTRUCCION</th>
      <td>1.120238</td>
      <td>0.928382</td>
    </tr>
    <tr>
      <th>AGRICULTURA Y PESCA</th>
      <td>1.563688</td>
      <td>0.871542</td>
    </tr>
    <tr>
      <th>CUERO Y PIEL</th>
      <td>0.683124</td>
      <td>0.833649</td>
    </tr>
    <tr>
      <th>ENSEÑANZA BASICA, MEDIA, F.P. Y SUPERIOR</th>
      <td>1.549962</td>
      <td>0.719970</td>
    </tr>
    <tr>
      <th>ASOCIACIONES, CONFEDERACIONES, FEDERACIONES Y CLUBS</th>
      <td>0.712687</td>
      <td>0.682077</td>
    </tr>
    <tr>
      <th>DISEÑO Y SERVICIOS DE CONSTRUCCION</th>
      <td>1.940620</td>
      <td>0.663130</td>
    </tr>
    <tr>
      <th>HOSTELERIA Y RESTAURACION</th>
      <td>2.053594</td>
      <td>0.663130</td>
    </tr>
    <tr>
      <th>MADERA Y PRODUCTOS DE MADERA</th>
      <td>0.787651</td>
      <td>0.644183</td>
    </tr>
    <tr>
      <th>CULTURA, OCIO E INSTALACIONES DEPORTIVAS</th>
      <td>1.161416</td>
      <td>0.568397</td>
    </tr>
    <tr>
      <th>TELECOMUNICACIONES</th>
      <td>0.546921</td>
      <td>0.492611</td>
    </tr>
    <tr>
      <th>OPTICA E INSTRUMENTOS DE PRECISION</th>
      <td>0.354760</td>
      <td>0.492611</td>
    </tr>
    <tr>
      <th>PAPEL</th>
      <td>0.257623</td>
      <td>0.416825</td>
    </tr>
    <tr>
      <th>ARTICULOS PROMOCIONALES</th>
      <td>0.326252</td>
      <td>0.416825</td>
    </tr>
    <tr>
      <th>VIDRIO, CERAMICA Y PORCELANA</th>
      <td>0.444505</td>
      <td>0.397878</td>
    </tr>
    <tr>
      <th>ASESORIA JURIDICA, ECONOMICA Y NOTARIAS</th>
      <td>1.232156</td>
      <td>0.359985</td>
    </tr>
    <tr>
      <th>OFICIOS INDEPENDIENTES</th>
      <td>0.401216</td>
      <td>0.322092</td>
    </tr>
    <tr>
      <th>OFICINAS, MOBILIARIO Y SUMINISTROS</th>
      <td>0.158375</td>
      <td>0.322092</td>
    </tr>
    <tr>
      <th>MEDICOS Y PROFESIONALES SANITARIOS</th>
      <td>0.804544</td>
      <td>0.265252</td>
    </tr>
    <tr>
      <th>PETROLEO, CARBON Y GAS</th>
      <td>0.403328</td>
      <td>0.208412</td>
    </tr>
    <tr>
      <th>FABRICANTES</th>
      <td>0.103472</td>
      <td>0.189466</td>
    </tr>
    <tr>
      <th>ENERGIA Y AGUA</th>
      <td>0.525805</td>
      <td>0.170519</td>
    </tr>
    <tr>
      <th>MINERIA PIEDRA Y TIERRA FAB MAY OFI</th>
      <td>0.238618</td>
      <td>0.113679</td>
    </tr>
    <tr>
      <th>EXPORTADORES / IMPORTADORES</th>
      <td>0.066517</td>
      <td>0.113679</td>
    </tr>
    <tr>
      <th>SEGUROS</th>
      <td>0.293521</td>
      <td>0.075786</td>
    </tr>
    <tr>
      <th>ORGANISMOS E INSTITUCIONES</th>
      <td>0.393825</td>
      <td>0.056840</td>
    </tr>
    <tr>
      <th>SERVICIOS FINANCIEROS Y CREDITICIOS</th>
      <td>0.487795</td>
      <td>0.037893</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Adding the <strong>mercado</strong> variable since the <strong>cnae_mercado</strong> variable will be taken into account since it encompasses a <strong>mercado</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;mercado&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;cnae_mercado&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;cnae_mercado&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_65_0.png" src="../../_images/Analysis_65_0.png" />
<img alt="../../_images/Analysis_65_1.png" src="../../_images/Analysis_65_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cnae_market</span> <span class="o">=</span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df_cnae_market</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_cnae_market</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACION DE VEHICULOS DE MOTOR Y MOTOCICLETAS</th>
      <td>39.568421</td>
      <td>47.120121</td>
    </tr>
    <tr>
      <th>INDUSTRIA MANUFACTURERA</th>
      <td>13.955575</td>
      <td>26.468359</td>
    </tr>
    <tr>
      <th>ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS</th>
      <td>7.698317</td>
      <td>7.086017</td>
    </tr>
    <tr>
      <th>INFORMACION Y COMUNICACIONES</th>
      <td>6.562361</td>
      <td>4.774536</td>
    </tr>
    <tr>
      <th>CONSTRUCCION</th>
      <td>8.499609</td>
      <td>2.804092</td>
    </tr>
    <tr>
      <th>ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS AUXILIARES</th>
      <td>3.615844</td>
      <td>2.425161</td>
    </tr>
    <tr>
      <th>OTROS SERVICIOS</th>
      <td>4.122590</td>
      <td>2.292535</td>
    </tr>
    <tr>
      <th>TRANSPORTE Y ALMACENAMIENTO</th>
      <td>2.220181</td>
      <td>1.762031</td>
    </tr>
    <tr>
      <th>ACTIVIDADES SANITARIAS Y DE SERVICIOS SOCIALES</th>
      <td>1.824286</td>
      <td>1.117848</td>
    </tr>
    <tr>
      <th>ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRETENIMIENTO</th>
      <td>1.466396</td>
      <td>0.757863</td>
    </tr>
    <tr>
      <th>AGRICULTURA, GANADERIA, SILVICULTURA Y PESCA</th>
      <td>1.391440</td>
      <td>0.682077</td>
    </tr>
    <tr>
      <th>EDUCACION</th>
      <td>1.467452</td>
      <td>0.663130</td>
    </tr>
    <tr>
      <th>HOSTELERIA</th>
      <td>2.060767</td>
      <td>0.663130</td>
    </tr>
    <tr>
      <th>ACTIVIDADES INMOBILIARIAS</th>
      <td>2.963409</td>
      <td>0.625237</td>
    </tr>
    <tr>
      <th>SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <td>0.314605</td>
      <td>0.265252</td>
    </tr>
    <tr>
      <th>ACTIVIDADES FINANCIERAS Y DE SEGUROS</th>
      <td>1.302760</td>
      <td>0.227359</td>
    </tr>
    <tr>
      <th>SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <td>0.461350</td>
      <td>0.170519</td>
    </tr>
    <tr>
      <th>ADMINISTRACION PUBLICA Y DEFENSA; SEGURIDAD SOCIAL OBLIGATORIA</th>
      <td>0.381115</td>
      <td>0.056840</td>
    </tr>
    <tr>
      <th>INDUSTRIAS EXTRACTIVAS</th>
      <td>0.106628</td>
      <td>0.037893</td>
    </tr>
    <tr>
      <th>Desconocido1</th>
      <td>0.010557</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ORGANISMOS EXTRATERRITORIALES</th>
      <td>0.006334</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_cnae_market</span><span class="p">[</span><span class="n">df_cnae_market</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>85.4490337248958
</pre></div>
</div>
</div>
</div>
<p>Creating a new variable called <strong>cnae_market_not_client</strong>. This variable contains the cnae_market that do not belong to 85% of the clients</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cnae_market_not_client</span> <span class="o">=</span> <span class="n">df_cnae_market</span><span class="p">[</span><span class="n">df_cnae_market</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">cnae_market_not_client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;CONSTRUCCION&#39;, &#39;ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS AUXILIARES&#39;,
       &#39;OTROS SERVICIOS&#39;, &#39;TRANSPORTE Y ALMACENAMIENTO&#39;,
       &#39;ACTIVIDADES SANITARIAS Y DE SERVICIOS SOCIALES&#39;,
       &#39;ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRETENIMIENTO&#39;,
       &#39;AGRICULTURA, GANADERIA, SILVICULTURA Y PESCA&#39;, &#39;EDUCACION&#39;,
       &#39;HOSTELERIA&#39;, &#39;ACTIVIDADES INMOBILIARIAS&#39;,
       &#39;SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION&#39;,
       &#39;ACTIVIDADES FINANCIERAS Y DE SEGUROS&#39;,
       &#39;SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO&#39;,
       &#39;ADMINISTRACION PUBLICA Y DEFENSA; SEGURIDAD SOCIAL OBLIGATORIA&#39;,
       &#39;INDUSTRIAS EXTRACTIVAS&#39;, &#39;Desconocido1&#39;,
       &#39;ORGANISMOS EXTRATERRITORIALES&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tipooficina&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tipooficina&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_70_0.png" src="../../_images/Analysis_70_0.png" />
<img alt="../../_images/Analysis_70_1.png" src="../../_images/Analysis_70_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>UNICA</th>
      <td>90.788835</td>
      <td>89.787798</td>
    </tr>
    <tr>
      <th>SEDE</th>
      <td>9.043306</td>
      <td>9.946950</td>
    </tr>
    <tr>
      <th>SUCURSAL</th>
      <td>0.167860</td>
      <td>0.265252</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;anyofundacion&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_fundacion</span><span class="o">.</span><span class="n">anyofundacion</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>anyofundacion</th>
      <th>Count</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>01/01/2005</td>
      <td>1204</td>
      <td>2005-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31/12/2004</td>
      <td>725</td>
      <td>2004-12-31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31/12/2003</td>
      <td>591</td>
      <td>2003-12-31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>01/01/2000</td>
      <td>559</td>
      <td>2000-01-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>01/01/2004</td>
      <td>555</td>
      <td>2004-01-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9837</th>
      <td>29/06/1989</td>
      <td>1</td>
      <td>1989-06-29</td>
    </tr>
    <tr>
      <th>9838</th>
      <td>18/02/1983</td>
      <td>1</td>
      <td>1983-02-18</td>
    </tr>
    <tr>
      <th>9839</th>
      <td>25/10/1948</td>
      <td>1</td>
      <td>1948-10-25</td>
    </tr>
    <tr>
      <th>9840</th>
      <td>13/05/1983</td>
      <td>1</td>
      <td>1983-05-13</td>
    </tr>
    <tr>
      <th>9841</th>
      <td>04/05/1993</td>
      <td>1</td>
      <td>1993-05-04</td>
    </tr>
  </tbody>
</table>
<p>9842 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_fundacion</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Count&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of company for year&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_75_0.png" src="../../_images/Analysis_75_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion_class</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;anyofundacion&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>01/01/2005</th>
      <td>1.318007</td>
      <td>1.412144</td>
    </tr>
    <tr>
      <th>31/12/2004</th>
      <td>0.806611</td>
      <td>0.625378</td>
    </tr>
    <tr>
      <th>01/01/2004</th>
      <td>0.616000</td>
      <td>0.504337</td>
    </tr>
    <tr>
      <th>31/12/2003</th>
      <td>0.659003</td>
      <td>0.484164</td>
    </tr>
    <tr>
      <th>01/01/2017</th>
      <td>0.161555</td>
      <td>0.463990</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>29/06/1989</th>
      <td>0.001162</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>18/02/1983</th>
      <td>0.001162</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25/10/1948</th>
      <td>0.001162</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13/05/1983</th>
      <td>0.001162</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>04/05/1993</th>
      <td>0.001162</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>9842 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion_class</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_fundacion_class</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">/%m/%Y&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_fundacion_class</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">df_fundacion_class</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">,</span><span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;sum&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rot</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of company for year and class&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_79_0.png" src="../../_images/Analysis_79_0.png" />
</div>
</div>
<p>Adding the <strong>anyofundacion</strong> variable since further it will be apply a transformation to this variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;anyofundacion&#39;</span><span class="p">)</span>
<span class="n">col_remove</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;id&#39;, &#39;tipo_empresa&#39;, &#39;actcnae&#39;, &#39;mercado&#39;, &#39;anyofundacion&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tendenciaempleados&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tendenciaempleados&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_82_0.png" src="../../_images/Analysis_82_0.png" />
<img alt="../../_images/Analysis_82_1.png" src="../../_images/Analysis_82_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>POSITIVA NO LINEAL</th>
      <td>35.834435</td>
      <td>49.870382</td>
    </tr>
    <tr>
      <th>POSITIVA LINEAL</th>
      <td>18.946196</td>
      <td>26.409592</td>
    </tr>
    <tr>
      <th>NEGATIVA LINEAL</th>
      <td>32.187188</td>
      <td>13.771873</td>
    </tr>
    <tr>
      <th>NEGATIVA NO LINEAL</th>
      <td>13.032180</td>
      <td>9.948153</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>tendenciaempleados</strong> variable is eliminated since it has more than 53% of missing values and it is dificult to impute all values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;tendenciaempleados&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tendenciaingresos&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;tendenciaingresos&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_86_0.png" src="../../_images/Analysis_86_0.png" />
<img alt="../../_images/Analysis_86_1.png" src="../../_images/Analysis_86_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>POSITIVA NO LINEAL</th>
      <td>39.268585</td>
      <td>43.607706</td>
    </tr>
    <tr>
      <th>POSITIVA LINEAL</th>
      <td>22.464885</td>
      <td>34.360771</td>
    </tr>
    <tr>
      <th>NEGATIVA NO LINEAL</th>
      <td>28.894028</td>
      <td>18.178634</td>
    </tr>
    <tr>
      <th>NEGATIVA LINEAL</th>
      <td>9.372502</td>
      <td>3.852890</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>tendenciaingresos</strong> variable is eliminated since it has more than 63% of missing values and it is dificult to impute all values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;tendenciaingresos&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;universo&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="s1">&#39;universo&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_90_0.png" src="../../_images/Analysis_90_0.png" />
<img alt="../../_images/Analysis_90_1.png" src="../../_images/Analysis_90_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ACTIVEBUSINESS</th>
      <td>45.44869</td>
      <td>69.192876</td>
    </tr>
    <tr>
      <th>MARKETBASE</th>
      <td>54.55131</td>
      <td>30.807124</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="analysis-of-numerical-variables">
<h2>Analysis of Numerical Variables<a class="headerlink" href="#analysis-of-numerical-variables" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numeric</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numeric</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>codpostal</th>
      <th>enpoligono</th>
      <th>habitantes_municipio</th>
      <th>tipo_de_zona</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>numoficinas</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>flotacamiones</th>
      <th>flotaautobuses</th>
      <th>existe_import</th>
      <th>existe_export</th>
      <th>existe_importexport</th>
      <th>existe_email</th>
      <th>es_ecommerce</th>
      <th>impactos_publicidad</th>
      <th>client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>46008</td>
      <td>0</td>
      <td>786189</td>
      <td>7</td>
      <td>7.0</td>
      <td>125.0</td>
      <td>NaN</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>28049</td>
      <td>0</td>
      <td>3141991</td>
      <td>7</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>8172</td>
      <td>0</td>
      <td>87830</td>
      <td>5</td>
      <td>7.0</td>
      <td>135.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>8011</td>
      <td>0</td>
      <td>1604555</td>
      <td>7</td>
      <td>6.0</td>
      <td>100.0</td>
      <td>NaN</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>28031</td>
      <td>1</td>
      <td>3141991</td>
      <td>7</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>99996</td>
      <td>8860</td>
      <td>0</td>
      <td>63891</td>
      <td>5</td>
      <td>3.0</td>
      <td>105.0</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>99997</td>
      <td>29018</td>
      <td>0</td>
      <td>569130</td>
      <td>7</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>99998</td>
      <td>46980</td>
      <td>0</td>
      <td>67340</td>
      <td>5</td>
      <td>7.0</td>
      <td>115.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>99999</td>
      <td>8021</td>
      <td>0</td>
      <td>1604555</td>
      <td>7</td>
      <td>6.0</td>
      <td>120.0</td>
      <td>0.0</td>
      <td>5</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>100000</td>
      <td>41011</td>
      <td>0</td>
      <td>693878</td>
      <td>7</td>
      <td>6.0</td>
      <td>115.0</td>
      <td>0.0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 20 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numeric</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;codpostal&#39;, &#39;enpoligono&#39;, &#39;habitantes_municipio&#39;, &#39;tipo_de_zona&#39;,
       &#39;rangoventas&#39;, &#39;rangoempleados&#39;, &#39;numoficinas&#39;, &#39;nse&#39;, &#39;flotaturismos&#39;,
       &#39;flotafurgonetas&#39;, &#39;flotacamiones&#39;, &#39;flotaautobuses&#39;, &#39;existe_import&#39;,
       &#39;existe_export&#39;, &#39;existe_importexport&#39;, &#39;existe_email&#39;, &#39;es_ecommerce&#39;,
       &#39;impactos_publicidad&#39;, &#39;client&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_numeric</span><span class="p">[</span><span class="n">df_numeric</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_96_0.png" src="../../_images/Analysis_96_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;enpoligono&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;enpoligono&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_97_0.png" src="../../_images/Analysis_97_0.png" />
<img alt="../../_images/Analysis_97_1.png" src="../../_images/Analysis_97_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>83.379785</td>
      <td>74.725275</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16.620215</td>
      <td>25.274725</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;tipo_de_zona&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;tipo_de_zona&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_99_0.png" src="../../_images/Analysis_99_0.png" />
<img alt="../../_images/Analysis_99_1.png" src="../../_images/Analysis_99_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>27.906928</td>
      <td>28.723001</td>
    </tr>
    <tr>
      <th>6</th>
      <td>20.425033</td>
      <td>18.321334</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14.050590</td>
      <td>15.782493</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11.869471</td>
      <td>11.348996</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10.767298</td>
      <td>10.742706</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.183949</td>
      <td>8.374384</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.796731</td>
      <td>6.707086</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;nse&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;nse&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_101_0.png" src="../../_images/Analysis_101_0.png" />
<img alt="../../_images/Analysis_101_1.png" src="../../_images/Analysis_101_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25.422816</td>
      <td>28.306177</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.174490</td>
      <td>23.796893</td>
    </tr>
    <tr>
      <th>4</th>
      <td>20.798758</td>
      <td>21.087533</td>
    </tr>
    <tr>
      <th>5</th>
      <td>18.089779</td>
      <td>19.988632</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.951922</td>
      <td>5.513452</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.562235</td>
      <td>1.307313</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotaturismos&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotaturismos&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_103_0.png" src="../../_images/Analysis_103_0.png" />
<img alt="../../_images/Analysis_103_1.png" src="../../_images/Analysis_103_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>91.765377</td>
      <td>87.438424</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.234623</td>
      <td>12.561576</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotafurgonetas&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotafurgonetas&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_105_0.png" src="../../_images/Analysis_105_0.png" />
<img alt="../../_images/Analysis_105_1.png" src="../../_images/Analysis_105_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>94.643272</td>
      <td>88.651004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.356728</td>
      <td>11.348996</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotacamiones&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotacamiones&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_107_0.png" src="../../_images/Analysis_107_0.png" />
<img alt="../../_images/Analysis_107_1.png" src="../../_images/Analysis_107_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98.295011</td>
      <td>97.29064</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.704989</td>
      <td>2.70936</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>flotacamiones</strong> is added to col_remove since there is no difference between customer and non-customer. 97% of clients are not truck fleet</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;flotacamiones&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotaautobuses&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;flotaautobuses&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_111_0.png" src="../../_images/Analysis_111_0.png" />
<img alt="../../_images/Analysis_111_1.png" src="../../_images/Analysis_111_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>99.952493</td>
      <td>99.924214</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.047507</td>
      <td>0.075786</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>flotaautobuses</strong> is added to col_remove since there is no difference between customer and non-customer. 99% of clients are not bus fleet</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;flotaautobuses&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_import&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_import&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_115_0.png" src="../../_images/Analysis_115_0.png" />
<img alt="../../_images/Analysis_115_1.png" src="../../_images/Analysis_115_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98.458647</td>
      <td>93.880258</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.541353</td>
      <td>6.119742</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>existe_import</strong> is added to col_remove since there is no difference between customer and non-customer. 94% of clients do not import</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;existe_import&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_export&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_export&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_119_0.png" src="../../_images/Analysis_119_0.png" />
<img alt="../../_images/Analysis_119_1.png" src="../../_images/Analysis_119_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>96.521399</td>
      <td>89.370974</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.478601</td>
      <td>10.629026</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_importexport&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_importexport&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_121_0.png" src="../../_images/Analysis_121_0.png" />
<img alt="../../_images/Analysis_121_1.png" src="../../_images/Analysis_121_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>98.776419</td>
      <td>94.960212</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.223581</td>
      <td>5.039788</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>existe_importexport</strong> is added to col_remove since there is no difference between customer and non-customer. 95% of clients do not import or export</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;existe_importexport&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_email&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;existe_email&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_125_0.png" src="../../_images/Analysis_125_0.png" />
<img alt="../../_images/Analysis_125_1.png" src="../../_images/Analysis_125_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>75.680412</td>
      <td>62.466844</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24.319588</td>
      <td>37.533156</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;es_ecommerce&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;es_ecommerce&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_127_0.png" src="../../_images/Analysis_127_0.png" />
<img alt="../../_images/Analysis_127_1.png" src="../../_images/Analysis_127_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>99.061464</td>
      <td>98.995832</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.938536</td>
      <td>1.004168</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>es_ecommerce</strong> is added to col_remove since there is no difference between customer and non-customer. 99% of clients are not ecommerce</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;es_ecommerce&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;rangoventas&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;rangoventas&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_131_0.png" src="../../_images/Analysis_131_0.png" />
<img alt="../../_images/Analysis_131_1.png" src="../../_images/Analysis_131_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5.0</th>
      <td>10.578436</td>
      <td>15.119363</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>28.475206</td>
      <td>14.323607</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>16.292058</td>
      <td>13.679424</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>5.956440</td>
      <td>12.618416</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>7.763854</td>
      <td>12.504737</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>9.473084</td>
      <td>12.296324</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>18.865933</td>
      <td>10.363774</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>2.078736</td>
      <td>7.218643</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>0.231205</td>
      <td>1.004168</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>0.285048</td>
      <td>0.871542</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;numoficinas&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;numoficinas&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_133_0.png" src="../../_images/Analysis_133_0.png" />
<img alt="../../_images/Analysis_133_1.png" src="../../_images/Analysis_133_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>94.736436</td>
      <td>91.645716</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>3.757643</td>
      <td>4.834655</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>0.824015</td>
      <td>1.798492</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>0.301845</td>
      <td>0.560820</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>0.062793</td>
      <td>0.212725</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>0.024236</td>
      <td>0.212725</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>0.124484</td>
      <td>0.193386</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>0.045167</td>
      <td>0.116032</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>0.016524</td>
      <td>0.077354</td>
    </tr>
    <tr>
      <th>12.0</th>
      <td>0.005508</td>
      <td>0.058016</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>0.009915</td>
      <td>0.038677</td>
    </tr>
    <tr>
      <th>54.0</th>
      <td>NaN</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>34.0</th>
      <td>0.001102</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>35.0</th>
      <td>NaN</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>337.0</th>
      <td>NaN</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>18.0</th>
      <td>NaN</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>33.0</th>
      <td>NaN</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>11.0</th>
      <td>0.007711</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>22.0</th>
      <td>0.002203</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>26.0</th>
      <td>0.002203</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>82.0</th>
      <td>0.002203</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>20.0</th>
      <td>0.003305</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>0.016524</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>49.0</th>
      <td>NaN</td>
      <td>0.019339</td>
    </tr>
    <tr>
      <th>13.0</th>
      <td>0.009915</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15.0</th>
      <td>0.004406</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16.0</th>
      <td>0.004406</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24.0</th>
      <td>0.003305</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>41.0</th>
      <td>0.003305</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>19.0</th>
      <td>0.003305</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14.0</th>
      <td>0.003305</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23.0</th>
      <td>0.002203</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>27.0</th>
      <td>0.002203</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>44.0</th>
      <td>0.002203</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>29.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>258.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>32.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>100.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>68.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>103.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>30.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>296.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>123.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>56.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>63.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>88.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>222.0</th>
      <td>0.001102</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <strong>numoficinas</strong> variable is eliminated since it more than 91% of clients does not office</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;numoficinas&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;impactos_publicidad&#39;</span><span class="p">)</span>
<span class="n">utils</span><span class="o">.</span><span class="n">plot_variable_per_target</span><span class="p">(</span><span class="n">df_numeric</span><span class="p">,</span><span class="s1">&#39;impactos_publicidad&#39;</span><span class="p">,</span><span class="s1">&#39;client&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_137_0.png" src="../../_images/Analysis_137_0.png" />
<img alt="../../_images/Analysis_137_1.png" src="../../_images/Analysis_137_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_class</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>27.302000</td>
      <td>66.464570</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.539853</td>
      <td>10.212202</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8.899728</td>
      <td>8.071239</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.086696</td>
      <td>5.589238</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.294082</td>
      <td>2.519894</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1.317540</td>
      <td>1.667298</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.708389</td>
      <td>1.117848</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.496189</td>
      <td>1.042061</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.361057</td>
      <td>0.776809</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.346276</td>
      <td>0.644183</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.392728</td>
      <td>0.568397</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.266042</td>
      <td>0.322092</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.348388</td>
      <td>0.303145</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.260763</td>
      <td>0.265252</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.214311</td>
      <td>0.246305</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.216423</td>
      <td>0.189466</td>
    </tr>
    <tr>
      <th>0</th>
      <td>39.949537</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;rangoempleados&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;rangoempleados without logarithmic smoothing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_139_0.png" src="../../_images/Analysis_139_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;habitantes_municipio&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;habitantes_municipio without logarithmic smoothing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_140_0.png" src="../../_images/Analysis_140_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;impactos_publicidad&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;impactos_publicidad&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_141_0.png" src="../../_images/Analysis_141_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_log</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;habitantes_municipio&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">df_log</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;habitantes_municipio&#39;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">df_log</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;habitantes_municipio with logarithmic smoothing&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_143_0.png" src="../../_images/Analysis_143_0.png" />
</div>
</div>
<p>The <strong>habitantes_municipio</strong> variable is eliminated since there is no difference in population between clients and non-clients</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;habitantes_municipio&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;id&#39;,
 &#39;tipo_empresa&#39;,
 &#39;actcnae&#39;,
 &#39;mercado&#39;,
 &#39;anyofundacion&#39;,
 &#39;tendenciaempleados&#39;,
 &#39;tendenciaingresos&#39;,
 &#39;flotacamiones&#39;,
 &#39;flotaautobuses&#39;,
 &#39;existe_import&#39;,
 &#39;existe_importexport&#39;,
 &#39;es_ecommerce&#39;,
 &#39;numoficinas&#39;,
 &#39;habitantes_municipio&#39;]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="correlation-between-variables">
<h2>Correlation between variables<a class="headerlink" href="#correlation-between-variables" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_num</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span><span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span>  <span class="n">df_num</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>


<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>


<span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>


<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=.</span><span class="mi">3</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="o">.</span><span class="mi">8</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Correlation between variables&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_149_0.png" src="../../_images/Analysis_149_0.png" />
</div>
</div>
<p>The following variables will be added to the list of variables to be eliminated since only the <strong>comunidadautonoma</strong> will be taken into account</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;codpostal&#39;</span><span class="p">,</span><span class="s1">&#39;municipio&#39;</span><span class="p">,</span><span class="s1">&#39;provincia&#39;</span><span class="p">]:</span>
    <span class="n">col_remove</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_remove</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;id&#39;,
 &#39;tipo_empresa&#39;,
 &#39;actcnae&#39;,
 &#39;mercado&#39;,
 &#39;anyofundacion&#39;,
 &#39;tendenciaempleados&#39;,
 &#39;tendenciaingresos&#39;,
 &#39;flotacamiones&#39;,
 &#39;flotaautobuses&#39;,
 &#39;existe_import&#39;,
 &#39;existe_importexport&#39;,
 &#39;es_ecommerce&#39;,
 &#39;numoficinas&#39;,
 &#39;habitantes_municipio&#39;,
 &#39;codpostal&#39;,
 &#39;municipio&#39;,
 &#39;provincia&#39;]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="preprocess-data">
<h1>Preprocess Data<a class="headerlink" href="#preprocess-data" title="Permalink to this headline">¶</a></h1>
<p>In this session, data is processed, cleaned, and training and test sets are created to train a propensity model to find potential customers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;tipo_empresa&#39;, &#39;codpostal&#39;, &#39;municipio&#39;, &#39;provincia&#39;,
       &#39;comunidadautonoma&#39;, &#39;capitalpueblo&#39;, &#39;enpoligono&#39;,
       &#39;habitantes_municipio&#39;, &#39;tipo_de_zona&#39;, &#39;actcnae&#39;, &#39;mercado&#39;,
       &#39;cnae_mercado&#39;, &#39;rangoventas&#39;, &#39;rangoempleados&#39;, &#39;numoficinas&#39;,
       &#39;tipooficina&#39;, &#39;anyofundacion&#39;, &#39;nse&#39;, &#39;tendenciaempleados&#39;,
       &#39;tendenciaingresos&#39;, &#39;flotaturismos&#39;, &#39;flotafurgonetas&#39;,
       &#39;flotacamiones&#39;, &#39;flotaautobuses&#39;, &#39;universo&#39;, &#39;existe_import&#39;,
       &#39;existe_export&#39;, &#39;existe_importexport&#39;, &#39;existe_email&#39;, &#39;es_ecommerce&#39;,
       &#39;impactos_publicidad&#39;, &#39;client&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preprocess</span> <span class="o">=</span> <span class="n">Preprocces</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Cleaning dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">clean_dataframe</span><span class="p">(</span><span class="n">col_remove</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2021-02-07][15:19:00][scripts.preprocess_data][INFO] Shape of dataframe:(100000, 33)
[2021-02-07][15:19:00][scripts.preprocess_data][INFO] Transform column anyofundacion to company years example: 2021-2017 --&gt; 4 year
[2021-02-07][15:19:00][scripts.preprocess_data][INFO] Remove variables [&#39;id&#39;, &#39;tipo_empresa&#39;, &#39;actcnae&#39;, &#39;mercado&#39;, &#39;anyofundacion&#39;, &#39;tendenciaempleados&#39;, &#39;tendenciaingresos&#39;, &#39;flotacamiones&#39;, &#39;flotaautobuses&#39;, &#39;existe_import&#39;, &#39;existe_importexport&#39;, &#39;es_ecommerce&#39;, &#39;numoficinas&#39;, &#39;habitantes_municipio&#39;, &#39;codpostal&#39;, &#39;municipio&#39;, &#39;provincia&#39;]
[2021-02-07][15:19:00][scripts.preprocess_data][INFO] Shape of dataframe:(100000, 17)
[2021-02-07][15:19:00][scripts.preprocess_data][INFO] Dataframe is cleaned
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>cnae_mercado</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>tipooficina</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>universo</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>client</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>COMUNITAT VALENCIANA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>CONSTRUCCION</td>
      <td>7.0</td>
      <td>125.0</td>
      <td>SEDE</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>INFORMACION Y COMUNICACIONES</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>5</td>
      <td>OTROS SERVICIOS</td>
      <td>7.0</td>
      <td>135.0</td>
      <td>SEDE</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>6.0</td>
      <td>100.0</td>
      <td>SEDE</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>1</td>
      <td>7</td>
      <td>INDUSTRIA MANUFACTURERA</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>SEDE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>1</td>
      <td>8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>enpoligono</th>
      <td>100000.0</td>
      <td>0.170770</td>
      <td>0.376310</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>tipo_de_zona</th>
      <td>100000.0</td>
      <td>4.710400</td>
      <td>2.134830</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>rangoventas</th>
      <td>99999.0</td>
      <td>3.222532</td>
      <td>2.084130</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>rangoempleados</th>
      <td>95996.0</td>
      <td>107.880849</td>
      <td>13.090275</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>105.0</td>
      <td>110.0</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>nse</th>
      <td>100000.0</td>
      <td>2.686010</td>
      <td>1.818663</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>flotaturismos</th>
      <td>100000.0</td>
      <td>0.084630</td>
      <td>0.278332</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>flotafurgonetas</th>
      <td>100000.0</td>
      <td>0.056730</td>
      <td>0.231327</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_export</th>
      <td>100000.0</td>
      <td>0.038560</td>
      <td>0.192545</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_email</th>
      <td>100000.0</td>
      <td>0.250170</td>
      <td>0.433113</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>impactos_publicidad</th>
      <td>100000.0</td>
      <td>1.557230</td>
      <td>2.287199</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>client</th>
      <td>100000.0</td>
      <td>0.052780</td>
      <td>0.223595</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>year</th>
      <td>90996.0</td>
      <td>13.443173</td>
      <td>11.034457</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>10.0</td>
      <td>20.0</td>
      <td>121.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="p">[</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;comunidadautonoma&#39;</span><span class="p">])[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">community_not_client</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>comunidadautonoma</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CASTILLA Y LEON</th>
      <td>4198</td>
    </tr>
    <tr>
      <th>ARAGON</th>
      <td>2579</td>
    </tr>
    <tr>
      <th>CASTILLA-LA MANCHA</th>
      <td>2752</td>
    </tr>
    <tr>
      <th>MURCIA</th>
      <td>2332</td>
    </tr>
    <tr>
      <th>NAVARRA</th>
      <td>1290</td>
    </tr>
    <tr>
      <th>ASTURIAS</th>
      <td>1267</td>
    </tr>
    <tr>
      <th>EXTREMADURA</th>
      <td>1544</td>
    </tr>
    <tr>
      <th>LA RIOJA</th>
      <td>717</td>
    </tr>
    <tr>
      <th>CANTABRIA</th>
      <td>793</td>
    </tr>
    <tr>
      <th>BALEARS</th>
      <td>16</td>
    </tr>
    <tr>
      <th>CANARIAS</th>
      <td>9</td>
    </tr>
    <tr>
      <th>CEUTA</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="p">[</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;cnae_mercado&#39;</span><span class="p">])[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;count&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cnae_market_not_client</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CONSTRUCCION</th>
      <td>8051</td>
    </tr>
    <tr>
      <th>ACTIVIDADES ADMINISTRATIVAS Y SERVICIOS AUXILIARES</th>
      <td>3425</td>
    </tr>
    <tr>
      <th>OTROS SERVICIOS</th>
      <td>3905</td>
    </tr>
    <tr>
      <th>TRANSPORTE Y ALMACENAMIENTO</th>
      <td>2103</td>
    </tr>
    <tr>
      <th>ACTIVIDADES SANITARIAS Y DE SERVICIOS SOCIALES</th>
      <td>1728</td>
    </tr>
    <tr>
      <th>ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRETENIMIENTO</th>
      <td>1389</td>
    </tr>
    <tr>
      <th>AGRICULTURA, GANADERIA, SILVICULTURA Y PESCA</th>
      <td>1318</td>
    </tr>
    <tr>
      <th>EDUCACION</th>
      <td>1390</td>
    </tr>
    <tr>
      <th>HOSTELERIA</th>
      <td>1952</td>
    </tr>
    <tr>
      <th>ACTIVIDADES INMOBILIARIAS</th>
      <td>2807</td>
    </tr>
    <tr>
      <th>SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <td>298</td>
    </tr>
    <tr>
      <th>ACTIVIDADES FINANCIERAS Y DE SEGUROS</th>
      <td>1234</td>
    </tr>
    <tr>
      <th>SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <td>437</td>
    </tr>
    <tr>
      <th>ADMINISTRACION PUBLICA Y DEFENSA; SEGURIDAD SOCIAL OBLIGATORIA</th>
      <td>361</td>
    </tr>
    <tr>
      <th>INDUSTRIAS EXTRACTIVAS</th>
      <td>101</td>
    </tr>
    <tr>
      <th>Desconocido1</th>
      <td>10</td>
    </tr>
    <tr>
      <th>ORGANISMOS EXTRATERRITORIALES</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_variables_nan</span><span class="p">(</span><span class="n">df_clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_162_0.png" src="../../_images/Analysis_162_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">df_nan</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Variables</th>
      <th>Number_of_nan</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>comunidadautonoma</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>capitalpueblo</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>enpoligono</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>tipo_de_zona</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cnae_mercado</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>rangoventas</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>rangoempleados</td>
      <td>4004</td>
    </tr>
    <tr>
      <th>7</th>
      <td>tipooficina</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>nse</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>flotaturismos</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>flotafurgonetas</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>universo</td>
      <td>13</td>
    </tr>
    <tr>
      <th>12</th>
      <td>existe_export</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>existe_email</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>impactos_publicidad</td>
      <td>0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>client</td>
      <td>0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>year</td>
      <td>9004</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="imputation-of-missing-values-in-numerical-data">
<h2>1- Imputation of Missing Values in numerical Data<a class="headerlink" href="#imputation-of-missing-values-in-numerical-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">fill_numerical_na</span><span class="p">([</span><span class="s1">&#39;rangoempleados&#39;</span><span class="p">,</span><span class="s1">&#39;rangoventas&#39;</span><span class="p">,</span><span class="s1">&#39;year&#39;</span><span class="p">],</span><span class="n">df_clean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>comunidadautonoma       0
capitalpueblo           0
enpoligono              0
tipo_de_zona            0
cnae_mercado            0
rangoventas             0
rangoempleados          0
tipooficina             0
nse                     0
flotaturismos           0
flotafurgonetas         0
universo               13
existe_export           0
existe_email            0
impactos_publicidad     0
client                  0
year                    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>enpoligono</th>
      <td>100000.0</td>
      <td>0.170770</td>
      <td>0.376310</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>tipo_de_zona</th>
      <td>100000.0</td>
      <td>4.710400</td>
      <td>2.134830</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>rangoventas</th>
      <td>100000.0</td>
      <td>3.222542</td>
      <td>2.084122</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>rangoempleados</th>
      <td>100000.0</td>
      <td>107.700720</td>
      <td>12.859431</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>105.0</td>
      <td>110.0</td>
      <td>210.0</td>
    </tr>
    <tr>
      <th>nse</th>
      <td>100000.0</td>
      <td>2.686010</td>
      <td>1.818663</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>flotaturismos</th>
      <td>100000.0</td>
      <td>0.084630</td>
      <td>0.278332</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>flotafurgonetas</th>
      <td>100000.0</td>
      <td>0.056730</td>
      <td>0.231327</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_export</th>
      <td>100000.0</td>
      <td>0.038560</td>
      <td>0.192545</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>existe_email</th>
      <td>100000.0</td>
      <td>0.250170</td>
      <td>0.433113</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>impactos_publicidad</th>
      <td>100000.0</td>
      <td>1.557230</td>
      <td>2.287199</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>client</th>
      <td>100000.0</td>
      <td>0.052780</td>
      <td>0.223595</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>year</th>
      <td>100000.0</td>
      <td>13.428320</td>
      <td>10.533847</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>12.0</td>
      <td>19.0</td>
      <td>121.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="encoded-categorical-variables-to-numeric">
<h2>2- Encoded Categorical variables to numeric<a class="headerlink" href="#encoded-categorical-variables-to-numeric" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;comunidadautonoma&#39;, &#39;capitalpueblo&#39;, &#39;cnae_mercado&#39;, &#39;tipooficina&#39;,
       &#39;universo&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_clean</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">df_clean</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="s1">&#39;object&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span><span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>...</th>
      <th>is_INDUSTRIAS EXTRACTIVAS</th>
      <th>is_INFORMACION Y COMUNICACIONES</th>
      <th>is_ORGANISMOS EXTRATERRITORIALES</th>
      <th>is_OTROS SERVICIOS</th>
      <th>is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <th>is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <th>is_TRANSPORTE Y ALMACENAMIENTO</th>
      <th>is_SUCURSAL</th>
      <th>is_UNICA</th>
      <th>is_MARKETBASE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>7</td>
      <td>7.0</td>
      <td>125.0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>7</td>
      <td>1.0</td>
      <td>103.0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>5</td>
      <td>7.0</td>
      <td>135.0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>7</td>
      <td>6.0</td>
      <td>100.0</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>7</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 53 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;enpoligono&#39;, &#39;tipo_de_zona&#39;, &#39;rangoventas&#39;, &#39;rangoempleados&#39;, &#39;nse&#39;,
       &#39;flotaturismos&#39;, &#39;flotafurgonetas&#39;, &#39;existe_export&#39;, &#39;existe_email&#39;,
       &#39;impactos_publicidad&#39;, &#39;client&#39;, &#39;year&#39;, &#39;is_ARAGON&#39;, &#39;is_ASTURIAS&#39;,
       &#39;is_BALEARS&#39;, &#39;is_CANARIAS&#39;, &#39;is_CANTABRIA&#39;, &#39;is_CASTILLA Y LEON&#39;,
       &#39;is_CASTILLA-LA MANCHA&#39;, &#39;is_CATALUNYA&#39;, &#39;is_CEUTA&#39;,
       &#39;is_COMUNITAT VALENCIANA&#39;, &#39;is_EXTREMADURA&#39;, &#39;is_GALICIA&#39;,
       &#39;is_LA RIOJA&#39;, &#39;is_MADRID&#39;, &#39;is_MURCIA&#39;, &#39;is_NAVARRA&#39;, &#39;is_PAIS VASCO&#39;,
       &#39;is_PUEBLO&#39;,
       &#39;is_ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRETENIMIENTO&#39;,
       &#39;is_ACTIVIDADES FINANCIERAS Y DE SEGUROS&#39;,
       &#39;is_ACTIVIDADES INMOBILIARIAS&#39;,
       &#39;is_ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS&#39;,
       &#39;is_ACTIVIDADES SANITARIAS Y DE SERVICIOS SOCIALES&#39;,
       &#39;is_ADMINISTRACION PUBLICA Y DEFENSA; SEGURIDAD SOCIAL OBLIGATORIA&#39;,
       &#39;is_AGRICULTURA, GANADERIA, SILVICULTURA Y PESCA&#39;,
       &#39;is_COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACION DE VEHICULOS DE MOTOR Y MOTOCICLETAS&#39;,
       &#39;is_CONSTRUCCION&#39;, &#39;is_Desconocido1&#39;, &#39;is_EDUCACION&#39;, &#39;is_HOSTELERIA&#39;,
       &#39;is_INDUSTRIA MANUFACTURERA&#39;, &#39;is_INDUSTRIAS EXTRACTIVAS&#39;,
       &#39;is_INFORMACION Y COMUNICACIONES&#39;, &#39;is_ORGANISMOS EXTRATERRITORIALES&#39;,
       &#39;is_OTROS SERVICIOS&#39;,
       &#39;is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION&#39;,
       &#39;is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO&#39;,
       &#39;is_TRANSPORTE Y ALMACENAMIENTO&#39;, &#39;is_SUCURSAL&#39;, &#39;is_UNICA&#39;,
       &#39;is_MARKETBASE&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 53)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="imputation-of-missing-values-in-categorical-data-with-knnimput">
<h2>3- Imputation of Missing Values in categorical Data with KnnImput<a class="headerlink" href="#imputation-of-missing-values-in-categorical-data-with-knnimput" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">fill_categorical_na</span><span class="p">(</span><span class="n">df_encode</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>enpoligono                                                                                   0
tipo_de_zona                                                                                 0
rangoventas                                                                                  0
rangoempleados                                                                               0
nse                                                                                          0
flotaturismos                                                                                0
flotafurgonetas                                                                              0
existe_export                                                                                0
existe_email                                                                                 0
impactos_publicidad                                                                          0
client                                                                                       0
year                                                                                         0
is_ARAGON                                                                                    0
is_ASTURIAS                                                                                  0
is_BALEARS                                                                                   0
is_CANARIAS                                                                                  0
is_CANTABRIA                                                                                 0
is_CASTILLA Y LEON                                                                           0
is_CASTILLA-LA MANCHA                                                                        0
is_CATALUNYA                                                                                 0
is_CEUTA                                                                                     0
is_COMUNITAT VALENCIANA                                                                      0
is_EXTREMADURA                                                                               0
is_GALICIA                                                                                   0
is_LA RIOJA                                                                                  0
is_MADRID                                                                                    0
is_MURCIA                                                                                    0
is_NAVARRA                                                                                   0
is_PAIS VASCO                                                                                0
is_PUEBLO                                                                                    0
is_ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRETENIMIENTO                                  0
is_ACTIVIDADES FINANCIERAS Y DE SEGUROS                                                      0
is_ACTIVIDADES INMOBILIARIAS                                                                 0
is_ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS                                         0
is_ACTIVIDADES SANITARIAS Y DE SERVICIOS SOCIALES                                            0
is_ADMINISTRACION PUBLICA Y DEFENSA; SEGURIDAD SOCIAL OBLIGATORIA                            0
is_AGRICULTURA, GANADERIA, SILVICULTURA Y PESCA                                              0
is_COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACION DE VEHICULOS DE MOTOR Y MOTOCICLETAS     0
is_CONSTRUCCION                                                                              0
is_Desconocido1                                                                              0
is_EDUCACION                                                                                 0
is_HOSTELERIA                                                                                0
is_INDUSTRIA MANUFACTURERA                                                                   0
is_INDUSTRIAS EXTRACTIVAS                                                                    0
is_INFORMACION Y COMUNICACIONES                                                              0
is_ORGANISMOS EXTRATERRITORIALES                                                             0
is_OTROS SERVICIOS                                                                           0
is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION    0
is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO                          0
is_TRANSPORTE Y ALMACENAMIENTO                                                               0
is_SUCURSAL                                                                                  0
is_UNICA                                                                                     0
is_MARKETBASE                                                                                0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>...</th>
      <th>is_INDUSTRIAS EXTRACTIVAS</th>
      <th>is_INFORMACION Y COMUNICACIONES</th>
      <th>is_ORGANISMOS EXTRATERRITORIALES</th>
      <th>is_OTROS SERVICIOS</th>
      <th>is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <th>is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <th>is_TRANSPORTE Y ALMACENAMIENTO</th>
      <th>is_SUCURSAL</th>
      <th>is_UNICA</th>
      <th>is_MARKETBASE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>125.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>103.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>135.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>100.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>105.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>115.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>120.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>115.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 53 columns</p>
</div></div></div>
</div>
<p>Cheking that there is not NaN</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>enpoligono                                                                                   0
tipo_de_zona                                                                                 0
rangoventas                                                                                  0
rangoempleados                                                                               0
nse                                                                                          0
flotaturismos                                                                                0
flotafurgonetas                                                                              0
existe_export                                                                                0
existe_email                                                                                 0
impactos_publicidad                                                                          0
client                                                                                       0
year                                                                                         0
is_ARAGON                                                                                    0
is_ASTURIAS                                                                                  0
is_BALEARS                                                                                   0
is_CANARIAS                                                                                  0
is_CANTABRIA                                                                                 0
is_CASTILLA Y LEON                                                                           0
is_CASTILLA-LA MANCHA                                                                        0
is_CATALUNYA                                                                                 0
is_CEUTA                                                                                     0
is_COMUNITAT VALENCIANA                                                                      0
is_EXTREMADURA                                                                               0
is_GALICIA                                                                                   0
is_LA RIOJA                                                                                  0
is_MADRID                                                                                    0
is_MURCIA                                                                                    0
is_NAVARRA                                                                                   0
is_PAIS VASCO                                                                                0
is_PUEBLO                                                                                    0
is_ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRETENIMIENTO                                  0
is_ACTIVIDADES FINANCIERAS Y DE SEGUROS                                                      0
is_ACTIVIDADES INMOBILIARIAS                                                                 0
is_ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS                                         0
is_ACTIVIDADES SANITARIAS Y DE SERVICIOS SOCIALES                                            0
is_ADMINISTRACION PUBLICA Y DEFENSA; SEGURIDAD SOCIAL OBLIGATORIA                            0
is_AGRICULTURA, GANADERIA, SILVICULTURA Y PESCA                                              0
is_COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACION DE VEHICULOS DE MOTOR Y MOTOCICLETAS     0
is_CONSTRUCCION                                                                              0
is_Desconocido1                                                                              0
is_EDUCACION                                                                                 0
is_HOSTELERIA                                                                                0
is_INDUSTRIA MANUFACTURERA                                                                   0
is_INDUSTRIAS EXTRACTIVAS                                                                    0
is_INFORMACION Y COMUNICACIONES                                                              0
is_ORGANISMOS EXTRATERRITORIALES                                                             0
is_OTROS SERVICIOS                                                                           0
is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION    0
is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO                          0
is_TRANSPORTE Y ALMACENAMIENTO                                                               0
is_SUCURSAL                                                                                  0
is_UNICA                                                                                     0
is_MARKETBASE                                                                                0
dtype: int64
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="selecting-the-companies-that-are-not-potential-clients">
<h2>4 - Selecting the companies that are not potential clients<a class="headerlink" href="#selecting-the-companies-that-are-not-potential-clients" title="Permalink to this headline">¶</a></h2>
<p>Two filters are applied to the dataframe to select the non-potential customers based on the following lists <strong>cnae_market_not_client</strong> and <strong>community_not_client</strong>.</p>
<p>A dataframe called <strong>df_not_client</strong> was created</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="p">[(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;cnae_mercado&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cnae_market_not_client</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;comunidadautonoma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">community_not_client</span><span class="p">))][</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>cnae_mercado</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>tipooficina</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>universo</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>client</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5278</th>
      <td>CASTILLA-LA MANCHA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>5</td>
      <td>ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRE...</td>
      <td>3.0</td>
      <td>105.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5292</th>
      <td>NAVARRA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>3</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>5306</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>CONSTRUCCION</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>5330</th>
      <td>ARAGON</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>2</td>
      <td>CONSTRUCCION</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5334</th>
      <td>EXTREMADURA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>3.0</td>
      <td>110.0</td>
      <td>UNICA</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99941</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>3</td>
      <td>CONSTRUCCION</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>SEDE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>99946</th>
      <td>CASTILLA Y LEON</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>ACTIVIDADES FINANCIERAS Y DE SEGUROS</td>
      <td>2.0</td>
      <td>105.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>99968</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>7.0</td>
      <td>115.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>ACTIVEBUSINESS</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>99969</th>
      <td>ASTURIAS</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>99973</th>
      <td>CASTILLA Y LEON</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>1</td>
      <td>CONSTRUCCION</td>
      <td>5.0</td>
      <td>120.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
<p>6063 rows × 17 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_not_client</span> <span class="o">=</span> <span class="n">df_clean</span><span class="p">[(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;cnae_mercado&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cnae_market_not_client</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;comunidadautonoma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">community_not_client</span><span class="p">))][</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_not_client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>cnae_mercado</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>tipooficina</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>universo</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>client</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5278</th>
      <td>CASTILLA-LA MANCHA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>5</td>
      <td>ACTIVIDADES ARTISTICAS, RECREATIVAS Y DE ENTRE...</td>
      <td>3.0</td>
      <td>105.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5292</th>
      <td>NAVARRA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>3</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>5306</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>CONSTRUCCION</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>5330</th>
      <td>ARAGON</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>2</td>
      <td>CONSTRUCCION</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>5334</th>
      <td>EXTREMADURA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>3.0</td>
      <td>110.0</td>
      <td>UNICA</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99941</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>3</td>
      <td>CONSTRUCCION</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>SEDE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>99946</th>
      <td>CASTILLA Y LEON</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>ACTIVIDADES FINANCIERAS Y DE SEGUROS</td>
      <td>2.0</td>
      <td>105.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>13.0</td>
    </tr>
    <tr>
      <th>99968</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>7.0</td>
      <td>115.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>ACTIVEBUSINESS</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>99969</th>
      <td>ASTURIAS</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>1</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>99973</th>
      <td>CASTILLA Y LEON</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>1</td>
      <td>CONSTRUCCION</td>
      <td>5.0</td>
      <td>120.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
<p>6063 rows × 17 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index_not_client</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df_not_client</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_clean</span><span class="p">[(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;cnae_mercado&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cnae_market_not_client</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;comunidadautonoma&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">community_not_client</span><span class="p">))][</span><span class="n">df_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(107, 17)
</pre></div>
</div>
</div>
</div>
<p>There are only 107 customers that meet the filter mentioned above, this represents 2% of customers</p>
</div>
<div class="section" id="creating-dataset-to-train-a-model">
<h2>5- Creating dataset to train a model<a class="headerlink" href="#creating-dataset-to-train-a-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>...</th>
      <th>is_INDUSTRIAS EXTRACTIVAS</th>
      <th>is_INFORMACION Y COMUNICACIONES</th>
      <th>is_ORGANISMOS EXTRATERRITORIALES</th>
      <th>is_OTROS SERVICIOS</th>
      <th>is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <th>is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <th>is_TRANSPORTE Y ALMACENAMIENTO</th>
      <th>is_SUCURSAL</th>
      <th>is_UNICA</th>
      <th>is_MARKETBASE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>125.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>103.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>135.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>100.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 53 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span><span class="p">[</span><span class="n">df_encode_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>...</th>
      <th>is_INDUSTRIAS EXTRACTIVAS</th>
      <th>is_INFORMACION Y COMUNICACIONES</th>
      <th>is_ORGANISMOS EXTRATERRITORIALES</th>
      <th>is_OTROS SERVICIOS</th>
      <th>is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <th>is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <th>is_TRANSPORTE Y ALMACENAMIENTO</th>
      <th>is_SUCURSAL</th>
      <th>is_UNICA</th>
      <th>is_MARKETBASE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>125.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>103.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>135.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>7.0</td>
      <td>6.0</td>
      <td>100.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5273</th>
      <td>0.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>100.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5274</th>
      <td>0.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>110.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5275</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>115.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5276</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>105.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5277</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>115.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5278 rows × 53 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_encode_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index_not_client</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>...</th>
      <th>is_INDUSTRIAS EXTRACTIVAS</th>
      <th>is_INFORMACION Y COMUNICACIONES</th>
      <th>is_ORGANISMOS EXTRATERRITORIALES</th>
      <th>is_OTROS SERVICIOS</th>
      <th>is_SUMINISTRO DE AGUA, ACTIVIDADES DE SANEAMIENTO, GESTION DE RESIDUOS Y DESCONTAMINACION</th>
      <th>is_SUMINISTRO DE ENERGIA ELECTRICA, GAS, VAPOR Y AIRE ACONDICIONADO</th>
      <th>is_TRANSPORTE Y ALMACENAMIENTO</th>
      <th>is_SUCURSAL</th>
      <th>is_UNICA</th>
      <th>is_MARKETBASE</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5278</th>
      <td>0.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>105.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5292</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>120.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5306</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5330</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5334</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>110.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99941</th>
      <td>0.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>99946</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>105.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>99968</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>7.0</td>
      <td>115.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99969</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>100.0</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>99973</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>120.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>6063 rows × 53 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_encode_clean</span><span class="p">[</span><span class="n">df_encode_clean</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">],</span><span class="n">df_encode_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index_not_client</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">df_encode_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">df_encode_clean</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">df_train</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;client&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0    6063
1.0    5278
Name: client, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Now we have a training set, in which we have clients and non-clients</p>
</div>
<div class="section" id="take-a-look-to-the-data">
<h2>6- Take a look to the data<a class="headerlink" href="#take-a-look-to-the-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">TSNE</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;client&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">client</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="n">Y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((11341, 52), (11341,))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Standardizing features by removing the mean and scaling to unit variance</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xs</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.44775767,  1.28399733,  1.57798065, ..., -0.06587378,
        -3.05430509, -0.8996383 ],
       [-0.44775767,  1.28399733, -1.04510066, ..., -0.06587378,
        -3.05430509,  1.11155783],
       [-0.44775767,  0.38202987,  1.57798065, ..., -0.06587378,
        -3.05430509, -0.8996383 ],
       ...,
       [-0.44775767, -1.42190506,  1.57798065, ..., -0.06587378,
        -3.05430509, -0.8996383 ],
       [-0.44775767, -1.42190506, -0.60792045, ..., -0.06587378,
         0.32740672, -0.8996383 ],
       [ 2.23335093, -1.42190506,  0.70362021, ..., -0.06587378,
         0.32740672, -0.8996383 ]])
</pre></div>
</div>
</div>
</div>
<p>T-SNE is a tool to visualize high-dimensional data. It converts similarities between data points to joint probabilities and tries to minimize the Kullback-Leibler divergence between the joint probabilities of the low-dimensional embedding and the high-dimensional data.
by: <strong>Scikit-learn</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_tsne</span> <span class="o">=</span> <span class="n">TSNE</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">perplexity</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Xs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tsne</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;comp_1&#39;</span><span class="p">:</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span><span class="s1">&#39;comp_2&#39;</span><span class="p">:</span><span class="n">X_tsne</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="n">df_tsne</span><span class="p">[</span><span class="s1">&#39;client&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tsne</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comp_1</th>
      <th>comp_2</th>
      <th>client</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-58.010624</td>
      <td>-43.520832</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>63.960674</td>
      <td>-44.193024</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.284826</td>
      <td>38.462612</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-13.702920</td>
      <td>-37.663956</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-34.083649</td>
      <td>-5.078753</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>11336</th>
      <td>-22.919600</td>
      <td>25.982742</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11337</th>
      <td>87.875824</td>
      <td>-8.644760</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11338</th>
      <td>-34.659439</td>
      <td>15.554616</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11339</th>
      <td>-60.212616</td>
      <td>8.521581</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>11340</th>
      <td>31.246439</td>
      <td>-39.077053</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>11341 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;comp_1&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;comp_2&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_tsne</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;client&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Customers and non-customers in two dimensions&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_209_0.png" src="../../_images/Analysis_209_0.png" />
</div>
</div>
<p>In the previous graph it can be seen that customers and non-customers are separated and grouped together, you can see certain clusters that contain customers and non-customers but this is because there are 2% of customers that have the same characteristics as non-potential customers.</p>
<p>This chart also helps verify that customer segmentation was done correctly.</p>
</div>
<div class="section" id="split-data-to-train-the-model">
<h2>7 Split data to train the model<a class="headerlink" href="#split-data-to-train-the-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>((9072, 52), (2269, 52), (9072,), (2269,))
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="train-a-model">
<h1>Train a Model<a class="headerlink" href="#train-a-model" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">BernoulliNB</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBClassifier</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">roc_curve</span><span class="p">,</span> <span class="n">f1_score</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="try-difference-clasifier">
<h2>Try Difference Clasifier<a class="headerlink" href="#try-difference-clasifier" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clfs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;mnb&#39;</span><span class="p">:</span> <span class="n">MultinomialNB</span><span class="p">(),</span>
    <span class="s1">&#39;gnb&#39;</span><span class="p">:</span> <span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="s1">&#39;mlp1&#39;</span><span class="p">:</span> <span class="n">MLPClassifier</span><span class="p">(),</span>
    <span class="s1">&#39;mlp2&#39;</span><span class="p">:</span> <span class="n">MLPClassifier</span><span class="p">(</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;logistic&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">),</span> <span class="n">learning_rate</span><span class="o">=</span> <span class="s1">&#39;adaptive&#39;</span> <span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">),</span>
    <span class="s1">&#39;ada&#39;</span><span class="p">:</span> <span class="n">AdaBoostClassifier</span><span class="p">(),</span>
    <span class="s1">&#39;dtc&#39;</span><span class="p">:</span> <span class="n">DecisionTreeClassifier</span><span class="p">(),</span>
    <span class="s1">&#39;rfc&#39;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(),</span>
    <span class="s1">&#39;gbc&#39;</span><span class="p">:</span> <span class="n">GradientBoostingClassifier</span><span class="p">(),</span>
    <span class="s1">&#39;lr&#39;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(),</span>
    <span class="s1">&#39;xgb&#39;</span><span class="p">:</span> <span class="n">XGBClassifier</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_scores</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">clf_name</span> <span class="ow">in</span> <span class="n">clfs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Clasifier : </span><span class="si">{</span><span class="n">clf_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">clfs</span><span class="p">[</span><span class="n">clf_name</span><span class="p">]</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">f1_scores</span><span class="p">[</span><span class="n">clf_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clasifier : mnb
Clasifier : gnb
Clasifier : mlp1
Clasifier : mlp2
Clasifier : ada
Clasifier : dtc
Clasifier : rfc
Clasifier : gbc
Clasifier : lr
Clasifier : xgb
[15:21:28] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.3.0/src/learner.cc:1061: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective &#39;binary:logistic&#39; was changed from &#39;error&#39; to &#39;logloss&#39;. Explicitly set eval_metric if you&#39;d like to restore the old behavior.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f1_scores</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;mnb&#39;: 0.97938662644545,
 &#39;gnb&#39;: 0.9853756933938477,
 &#39;mlp1&#39;: 0.991008991008991,
 &#39;mlp2&#39;: 0.9914786967418545,
 &#39;ada&#39;: 0.985390428211587,
 &#39;dtc&#39;: 0.9680275454992622,
 &#39;rfc&#39;: 0.9869083585095669,
 &#39;gbc&#39;: 0.985390428211587,
 &#39;lr&#39;: 0.9797979797979798,
 &#39;xgb&#39;: 0.991}
</pre></div>
</div>
</div>
</div>
<p>Apparently all the models work correctly, what may be happening is that it is falling into an overfitting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">best_model</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">f1_scores</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">f1_scores</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The best model is </span><span class="si">{</span><span class="n">best_model</span><span class="si">}</span><span class="s1"> with f1_score :</span><span class="si">{</span><span class="n">f1_scores</span><span class="p">[</span><span class="n">best_model</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The best model is mlp2 with f1_score :0.9914786967418545
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="try-mlp">
<h2>Try MLP<a class="headerlink" href="#try-mlp" title="Permalink to this headline">¶</a></h2>
<p>It will be tested with MLP to show that it is falling into overfitting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span><span class="n">MLPClassifier</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">proba</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proba</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.25853594e-09, 9.99999999e-01],
       [9.92015962e-01, 7.98403807e-03],
       [1.78703006e-06, 9.99998213e-01],
       ...,
       [9.93223413e-01, 6.77658726e-03],
       [3.63471253e-10, 1.00000000e+00],
       [1.84874634e-03, 9.98151254e-01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         0.0       1.00      0.99      0.99      1276
         1.0       0.99      1.00      0.99       993

    accuracy                           0.99      2269
   macro avg       0.99      0.99      0.99      2269
weighted avg       0.99      0.99      0.99      2269
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x1db9668ca20&gt;
</pre></div>
</div>
<img alt="../../_images/Analysis_227_1.png" src="../../_images/Analysis_227_1.png" />
</div>
</div>
<p>The prediction is made in the test set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_mlp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_mlp</span><span class="p">[</span><span class="n">result_mlp</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=int64)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_mlp</span><span class="p">[</span><span class="n">result_mlp</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">result_mlp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>99.40897145241883
</pre></div>
</div>
</div>
</div>
<p>This result says that 99% are potential customers, which does not make sense</p>
</div>
<div class="section" id="try-logisticregression">
<h2>Try LogisticRegression.<a class="headerlink" href="#try-logisticregression" title="Permalink to this headline">¶</a></h2>
<p>It will be tested with Logistic Regression to show a good result and it uses a hyperparameter C to avoid overfitting adding stronger regularization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.07948142, 0.92051858],
       [0.51009116, 0.48990884],
       [0.33330286, 0.66669714],
       ...,
       [0.58781193, 0.41218807],
       [0.06666302, 0.93333698],
       [0.66168637, 0.33831363]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              precision    recall  f1-score   support

         0.0       0.91      0.85      0.88      1344
         1.0       0.80      0.87      0.84       925

    accuracy                           0.86      2269
   macro avg       0.86      0.86      0.86      2269
weighted avg       0.87      0.86      0.86      2269
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8620537681798149
</pre></div>
</div>
</div>
</div>
<p>The table above shows what is the performance of the model by class. The model achieve 87% the accuracy for the class 1 and 85% for the class 0, in general the has 86% of accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;sklearn.metrics._plot.confusion_matrix.ConfusionMatrixDisplay at 0x1db99345eb8&gt;
</pre></div>
</div>
<img alt="../../_images/Analysis_239_1.png" src="../../_images/Analysis_239_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_lr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_lr</span><span class="p">[</span><span class="n">result_lr</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">result_lr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>41.46448753087673
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_lr</span><span class="p">[</span><span class="n">result_lr</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="n">result_lr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>58.53551246912327
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proba_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">fpr</span><span class="p">,</span> <span class="n">tpr</span><span class="p">,</span> <span class="n">thresh</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">proba_pred</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">auc</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">proba_pred</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">lw</span><span class="o">=</span><span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fpr</span><span class="p">,</span><span class="n">tpr</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkorange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;ROC curve (area=</span><span class="si">%0.2f</span><span class="s1">)&#39;</span> <span class="o">%</span><span class="k">auc</span>)
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;False positive rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True positive rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ROC&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Analysis_244_0.png" src="../../_images/Analysis_244_0.png" />
</div>
</div>
<p>The auc of roc curve achieve 94% it is a very good result for the model</p>
</div>
</div>
<div class="section" id="choosing-the-best-model">
<h1>Choosing the best model<a class="headerlink" href="#choosing-the-best-model" title="Permalink to this headline">¶</a></h1>
<p>With the results obtained, the best model is lr for the train set</p>
<p>The model was called lr.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
</pre></div>
</div>
</div>
</div>
<p>Saving a model into a pickle, this avoid to train the model again.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">clf_final</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../../models/model_lr.pickle&#39;</span><span class="p">,</span><span class="s1">&#39;rb&#39;</span><span class="p">))</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../../models/model_lr.pickle&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="making-prediction">
<h1>Making Prediction<a class="headerlink" href="#making-prediction" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">clf_final</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">df_test</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.69907913, 0.30092087],
       [0.40463482, 0.59536518],
       [0.20234604, 0.79765396],
       ...,
       [0.25817618, 0.74182382],
       [0.28628061, 0.71371939],
       [0.15713991, 0.84286009]])
</pre></div>
</div>
</div>
</div>
<p>Creating a new dataframe called df_result to see and select the potencial clients</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_result</span> <span class="o">=</span> <span class="n">df_clean</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_test</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;client&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Creating new columns with probabilty for each class</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_result</span><span class="p">[</span><span class="s1">&#39;proba_0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">df_result</span><span class="p">[</span><span class="s1">&#39;proba_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Sort dataframe with the highest probability to class 1 that represent the potencial client</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;proba_1&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>cnae_mercado</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>tipooficina</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>universo</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>year</th>
      <th>proba_0</th>
      <th>proba_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59080</th>
      <td>MADRID</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>6</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12.0</td>
      <td>0.016746</td>
      <td>0.983254</td>
    </tr>
    <tr>
      <th>53776</th>
      <td>MADRID</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>5</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0.020202</td>
      <td>0.979798</td>
    </tr>
    <tr>
      <th>56021</th>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>6</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>16.0</td>
      <td>0.021286</td>
      <td>0.978714</td>
    </tr>
    <tr>
      <th>96933</th>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>10.0</td>
      <td>110.0</td>
      <td>UNICA</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0</td>
      <td>0.021429</td>
      <td>0.978571</td>
    </tr>
    <tr>
      <th>84535</th>
      <td>MURCIA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>4</td>
      <td>INDUSTRIA MANUFACTURERA</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>SEDE</td>
      <td>3</td>
      <td>0</td>
      <td>1</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>21.0</td>
      <td>0.023763</td>
      <td>0.976237</td>
    </tr>
    <tr>
      <th>29158</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>6.0</td>
      <td>0.024122</td>
      <td>0.975878</td>
    </tr>
    <tr>
      <th>21826</th>
      <td>COMUNITAT VALENCIANA</td>
      <td>PUEBLO</td>
      <td>0</td>
      <td>4</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12.0</td>
      <td>0.025307</td>
      <td>0.974693</td>
    </tr>
    <tr>
      <th>90682</th>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>INDUSTRIA MANUFACTURERA</td>
      <td>10.0</td>
      <td>110.0</td>
      <td>UNICA</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>12.0</td>
      <td>0.029145</td>
      <td>0.970855</td>
    </tr>
    <tr>
      <th>88338</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>INDUSTRIA MANUFACTURERA</td>
      <td>10.0</td>
      <td>100.0</td>
      <td>UNICA</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>16.0</td>
      <td>0.029992</td>
      <td>0.970008</td>
    </tr>
    <tr>
      <th>85888</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>10.0</td>
      <td>115.0</td>
      <td>UNICA</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12.0</td>
      <td>0.030060</td>
      <td>0.969940</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_clean</span><span class="o">.</span><span class="n">comunidadautonoma</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">community_not_client</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;COMUNITAT VALENCIANA&#39;,
 &#39;CATALUNYA&#39;,
 &#39;ANDALUCIA&#39;,
 &#39;GALICIA&#39;,
 &#39;MADRID&#39;,
 &#39;PAIS VASCO&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">df_clean</span><span class="o">.</span><span class="n">cnae_mercado</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">cnae_market_not_client</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS&#39;,
 &#39;INDUSTRIA MANUFACTURERA&#39;,
 &#39;COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACION DE VEHICULOS DE MOTOR Y MOTOCICLETAS&#39;,
 &#39;INFORMACION Y COMUNICACIONES&#39;]
</pre></div>
</div>
</div>
</div>
<div class="section" id="criteria-final-in-the-choice-of-companies">
<h2>Criteria final in the choice of companies<a class="headerlink" href="#criteria-final-in-the-choice-of-companies" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_result</span><span class="p">[(</span><span class="o">~</span><span class="n">df_result</span><span class="o">.</span><span class="n">impactos_publicidad</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">community_not_client</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_result</span><span class="o">.</span><span class="n">impactos_publicidad</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_result</span><span class="o">.</span><span class="n">proba_1</span><span class="o">&gt;</span><span class="mf">0.95</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;proba_1&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>comunidadautonoma</th>
      <th>capitalpueblo</th>
      <th>enpoligono</th>
      <th>tipo_de_zona</th>
      <th>cnae_mercado</th>
      <th>rangoventas</th>
      <th>rangoempleados</th>
      <th>tipooficina</th>
      <th>nse</th>
      <th>flotaturismos</th>
      <th>flotafurgonetas</th>
      <th>universo</th>
      <th>existe_export</th>
      <th>existe_email</th>
      <th>impactos_publicidad</th>
      <th>year</th>
      <th>proba_0</th>
      <th>proba_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59080</th>
      <td>MADRID</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>6</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12.0</td>
      <td>0.016746</td>
      <td>0.983254</td>
    </tr>
    <tr>
      <th>53776</th>
      <td>MADRID</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>5</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0.020202</td>
      <td>0.979798</td>
    </tr>
    <tr>
      <th>56021</th>
      <td>CATALUNYA</td>
      <td>PUEBLO</td>
      <td>1</td>
      <td>6</td>
      <td>TRANSPORTE Y ALMACENAMIENTO</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>16.0</td>
      <td>0.021286</td>
      <td>0.978714</td>
    </tr>
    <tr>
      <th>96933</th>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>10.0</td>
      <td>110.0</td>
      <td>UNICA</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0</td>
      <td>0.021429</td>
      <td>0.978571</td>
    </tr>
    <tr>
      <th>29158</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>ACTIVIDADES PROFESIONALES, CIENTIFICAS Y TECNICAS</td>
      <td>7.0</td>
      <td>0.0</td>
      <td>UNICA</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>MARKETBASE</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>6.0</td>
      <td>0.024122</td>
      <td>0.975878</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>16574</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>8.0</td>
      <td>105.0</td>
      <td>UNICA</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7.0</td>
      <td>0.049318</td>
      <td>0.950682</td>
    </tr>
    <tr>
      <th>48305</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>1</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>8.0</td>
      <td>110.0</td>
      <td>UNICA</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9.0</td>
      <td>0.049512</td>
      <td>0.950488</td>
    </tr>
    <tr>
      <th>31157</th>
      <td>MADRID</td>
      <td>CAPITAL</td>
      <td>1</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>10.0</td>
      <td>145.0</td>
      <td>UNICA</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>14.0</td>
      <td>0.049568</td>
      <td>0.950432</td>
    </tr>
    <tr>
      <th>5566</th>
      <td>PAIS VASCO</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>6</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>9.0</td>
      <td>105.0</td>
      <td>UNICA</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>10.0</td>
      <td>0.049599</td>
      <td>0.950401</td>
    </tr>
    <tr>
      <th>67832</th>
      <td>CATALUNYA</td>
      <td>CAPITAL</td>
      <td>0</td>
      <td>7</td>
      <td>COMERCIO AL POR MAYOR Y AL POR MENOR; REPARACI...</td>
      <td>9.0</td>
      <td>140.0</td>
      <td>UNICA</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>ACTIVEBUSINESS</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>12.0</td>
      <td>0.049994</td>
      <td>0.950006</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 18 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_result</span><span class="p">[(</span><span class="o">~</span><span class="n">df_result</span><span class="o">.</span><span class="n">impactos_publicidad</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">community_not_client</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_result</span><span class="o">.</span><span class="n">impactos_publicidad</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df_result</span><span class="o">.</span><span class="n">proba_1</span><span class="o">&gt;</span><span class="mf">0.95</span><span class="p">)]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;proba_1&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;../../result/predict_potencial_client.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./code\notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='right-next' id="next-link" href="../../Explanation.html" title="next page">Methodology</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Jorge A Flores S<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>